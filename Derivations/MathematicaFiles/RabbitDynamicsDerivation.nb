(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    143504,       3652]
NotebookOptionsPosition[    140657,       3560]
NotebookOutlinePosition[    141197,       3580]
CellTagsIndexPosition[    141154,       3577]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Initialization", "Section",
 CellChangeTimes->{{3.587054562815436*^9, 3.5870545683829927`*^9}, 
   3.7639210008236065`*^9, {3.763922322016376*^9, 3.763922332416171*^9}, {
   3.7685736312280703`*^9, 3.768573641896326*^9}, {3.7778182597402086`*^9, 
   3.777818268541385*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Off", "[", 
   RowBox[{
    RowBox[{"General", "::", "spell"}], ",", 
    RowBox[{"General", "::", "spell1"}], ",", 
    StyleBox[
     RowBox[{"Get", "::", "noopen"}], "MessageName"], 
    StyleBox[",", "MessageName"], 
    StyleBox[
     RowBox[{"Needs", "::", "nocont"}], "MessageName"]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<Screws`\>\"", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<RobotLinks`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<ToMatlab`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"FindFile", "[", "\"\<Screws`\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"FindFile", "[", "\"\<RobotLinks`\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"FindFile", "[", "\"\<ToMatlab`\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{"_", "\[Element]", "Reals"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.796131444412054*^9, 3.796131445235584*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"EndPackage", "::", "noctx"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"No previous context defined. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/EndPackage/noctx\\\", ButtonNote -> \
\\\"EndPackage::noctx\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.810468721548997*^9, 3.8104689011084075`*^9, 
  3.8104690528749213`*^9}],

Cell[BoxData["\<\"C:\\\\Users\\\\mxy110230\\\\AppData\\\\Roaming\\\\\
Mathematica\\\\Applications\\\\Screws.m\"\>"], "Output",
 CellChangeTimes->{
  3.7961317704748774`*^9, 3.796738100129743*^9, 3.7973396489937716`*^9, 
   3.809179695284107*^9, {3.8091809257845154`*^9, 3.8091809541743383`*^9}, 
   3.810467675161912*^9, 3.810467709983783*^9, 3.810467843392301*^9, 
   3.8104685052827272`*^9, 3.810468721555028*^9, 3.810468901130407*^9, 
   3.8104690528989153`*^9}],

Cell[BoxData["\<\"C:\\\\Users\\\\mxy110230\\\\AppData\\\\Roaming\\\\\
Mathematica\\\\Applications\\\\RobotLinks.m\"\>"], "Output",
 CellChangeTimes->{
  3.7961317704748774`*^9, 3.796738100129743*^9, 3.7973396489937716`*^9, 
   3.809179695284107*^9, {3.8091809257845154`*^9, 3.8091809541743383`*^9}, 
   3.810467675161912*^9, 3.810467709983783*^9, 3.810467843392301*^9, 
   3.8104685052827272`*^9, 3.810468721555028*^9, 3.810468901130407*^9, 
   3.810469052902918*^9}],

Cell[BoxData["\<\"C:\\\\Users\\\\mxy110230\\\\AppData\\\\Roaming\\\\\
Mathematica\\\\Applications\\\\ToMatlab.m\"\>"], "Output",
 CellChangeTimes->{
  3.7961317704748774`*^9, 3.796738100129743*^9, 3.7973396489937716`*^9, 
   3.809179695284107*^9, {3.8091809257845154`*^9, 3.8091809541743383`*^9}, 
   3.810467675161912*^9, 3.810467709983783*^9, 3.810467843392301*^9, 
   3.8104685052827272`*^9, 3.810468721555028*^9, 3.810468901130407*^9, 
   3.8104690529069457`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Point Foot Open Chain Kinematics", "Section",
 CellChangeTimes->{{3.587054562815436*^9, 3.5870545683829927`*^9}, 
   3.7639210008236065`*^9, {3.763922322016376*^9, 3.763922332416171*^9}, {
   3.7685736312280703`*^9, 3.768573641896326*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MatrixForm", "[", 
   RowBox[{"x", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x1", "[", "t", "]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x2", "[", "t", "]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x3", "[", "t", "]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x4", "[", "t", "]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x5", "[", "t", "]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x6", "[", "t", "]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x7", "[", "t", "]"}], "}"}]}], "}"}]}], "]"}], " ", ";", 
  RowBox[{"(*", " ", 
   RowBox[{"xhip", ",", "yhip", ",", " ", 
    RowBox[{"thigh", " ", "1"}], ",", " ", 
    RowBox[{"shank", " ", "1"}], ",", " ", 
    RowBox[{"thigh", " ", "2"}], ",", " ", 
    RowBox[{"shank", " ", "2"}], ",", " ", 
    RowBox[{"torso", " ", "angle"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"MatrixForm", "[", 
   RowBox[{"xdot", " ", "=", " ", 
    RowBox[{"D", "[", 
     RowBox[{"x", ",", "t"}], "]"}]}], " ", "]"}], ";"}]], "Input",
 CellChangeTimes->{
  3.5111737472017937`*^9, {3.511173782073788*^9, 3.5111737868600616`*^9}, {
   3.5111755940464272`*^9, 3.511175600408791*^9}, {3.520686131703125*^9, 
   3.520686135875*^9}, {3.520686309671875*^9, 3.520686312484375*^9}, {
   3.520687115453125*^9, 3.5206871275625*^9}, {3.52078867884375*^9, 
   3.52078872540625*^9}, {3.520857852828125*^9, 3.520857856765625*^9}, {
   3.521820034578125*^9, 3.52182003665625*^9}, {3.521820194515625*^9, 
   3.52182019925*^9}, {3.521911060609375*^9, 3.52191106496875*^9}, 
   3.5219945113125*^9, {3.523028145328125*^9, 3.523028147203125*^9}, 
   3.523028568734375*^9, {3.523033556203125*^9, 3.5230335580625*^9}, {
   3.52303366240625*^9, 3.523033664046875*^9}, {3.5232996586875*^9, 
   3.523299669890625*^9}, 3.523299712796875*^9, {3.52330022171875*^9, 
   3.523300234421875*^9}, {3.52330028559375*^9, 3.52330029028125*^9}, 
   3.5233008249375*^9, {3.523360415484375*^9, 3.523360421828125*^9}, {
   3.523380309234375*^9, 3.52338031990625*^9}, {3.523380358796875*^9, 
   3.523380364234375*^9}, {3.5287165611401763`*^9, 3.5287165746088295`*^9}, {
   3.543073868103307*^9, 3.543073894812307*^9}, 3.5430739902623067`*^9, {
   3.5430742662443066`*^9, 3.543074273445307*^9}, 3.5430744729683065`*^9, {
   3.5430748729733067`*^9, 3.5430748749423065`*^9}, {3.555095285078673*^9, 
   3.5550952976686726`*^9}, {3.5553255793781047`*^9, 3.555325590112178*^9}, 
   3.5559492285885787`*^9, {3.587054558588013*^9, 3.587054560969251*^9}, {
   3.7639210046785345`*^9, 3.763921006646368*^9}, {3.7639223376326623`*^9, 
   3.7639223408171253`*^9}, {3.7639888827120976`*^9, 3.763988883260669*^9}, {
   3.7639889168895807`*^9, 3.7639889213377137`*^9}, {3.7668387110156374`*^9, 
   3.766838742199313*^9}, {3.7668390632542467`*^9, 3.7668390653021955`*^9}, {
   3.76685038634461*^9, 3.7668503867767572`*^9}, {3.7669333887464466`*^9, 
   3.7669334534522886`*^9}, {3.766934137961943*^9, 3.76693415384387*^9}, {
   3.7778174843224115`*^9, 3.777817484932766*^9}, {3.8104656065543694`*^9, 
   3.8104656071113253`*^9}, {3.810465764102665*^9, 3.810465790171584*^9}, {
   3.8104665036184464`*^9, 3.8104665421793213`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ax1", " ", "=", " ", 
   RowBox[{"PrismaticTwist", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ax2", " ", "=", " ", 
   RowBox[{"PrismaticTwist", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ax3", " ", "=", " ", 
   RowBox[{"RevoluteTwist", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ax4", " ", "=", " ", 
   RowBox[{"RevoluteTwist", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "lth"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"axzero", " ", "=", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixForm", "[", 
   RowBox[{"e1", " ", "=", " ", 
    RowBox[{"TwistExp", "[", 
     RowBox[{"ax1", ",", 
      RowBox[{"x1", "[", "t", "]"}]}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixForm", "[", 
   RowBox[{"e2", " ", "=", " ", 
    RowBox[{"TwistExp", "[", 
     RowBox[{"ax2", ",", 
      RowBox[{"x2", "[", "t", "]"}]}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixForm", "[", 
   RowBox[{"e3", " ", "=", " ", 
    RowBox[{"TwistExp", "[", 
     RowBox[{"ax3", ",", 
      RowBox[{"x3", "[", "t", "]"}]}], "]"}]}], "]"}], ";", " ", 
  RowBox[{"(*", 
   RowBox[{"Hip", " ", "1"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"MatrixForm", "[", 
   RowBox[{"e4", " ", "=", " ", 
    RowBox[{"TwistExp", "[", 
     RowBox[{"ax4", ",", 
      RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], "]"}], ";", " ", 
  RowBox[{"(*", 
   RowBox[{"Knee", " ", "1"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"MatrixForm", "[", 
   RowBox[{"e5", " ", "=", " ", 
    RowBox[{"TwistExp", "[", 
     RowBox[{"ax3", ",", 
      RowBox[{"x5", "[", "t", "]"}]}], "]"}]}], "]"}], ";", " ", 
  RowBox[{"(*", 
   RowBox[{"Hip", " ", "1"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"MatrixForm", "[", 
   RowBox[{"e6", " ", "=", " ", 
    RowBox[{"TwistExp", "[", 
     RowBox[{"ax4", ",", 
      RowBox[{"x6", "[", "t", "]"}]}], "]"}]}], "]"}], ";", " ", 
  RowBox[{"(*", 
   RowBox[{"Knee", " ", "1"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"MatrixForm", "[", 
   RowBox[{"e7", " ", "=", " ", 
    RowBox[{"TwistExp", "[", 
     RowBox[{"ax3", ",", 
      RowBox[{"x7", "[", "t", "]"}]}], "]"}]}], "]"}], ";", " ", 
  RowBox[{"(*", "Torso", "*)"}], "\[IndentingNewLine]"}]}], "Input",
 CellChangeTimes->{{3.520686144890625*^9, 3.520686145203125*^9}, {
   3.52068617653125*^9, 3.520686205625*^9}, {3.520686284921875*^9, 
   3.520686305984375*^9}, {3.520686374484375*^9, 3.520686441609375*^9}, {
   3.52068650903125*^9, 3.520686509140625*^9}, {3.52068656871875*^9, 
   3.520686617546875*^9}, {3.5206873421875*^9, 3.520687418140625*^9}, {
   3.5207688911875*^9, 3.520768891421875*^9}, {3.5208577891875*^9, 
   3.5208577938125*^9}, {3.52182001190625*^9, 3.521820023734375*^9}, {
   3.521911082890625*^9, 3.52191115175*^9}, {3.52191125971875*^9, 
   3.521911294796875*^9}, {3.521911335375*^9, 3.5219113548125*^9}, {
   3.5219119563125*^9, 3.521911956390625*^9}, {3.521994532609375*^9, 
   3.521994535875*^9}, {3.52206939596875*^9, 3.5220694045625*^9}, {
   3.523028084703125*^9, 3.523028115890625*^9}, 3.523028291140625*^9, 
   3.523033323140625*^9, 3.523033450765625*^9, {3.52303353259375*^9, 
   3.5230335539375*^9}, {3.5230373085*^9, 3.52303737340625*^9}, {
   3.523037467328125*^9, 3.52303746903125*^9}, 3.52330047*^9, {
   3.523358999328125*^9, 3.52335906684375*^9}, {3.523360273125*^9, 
   3.523360357953125*^9}, {3.5233608009375*^9, 3.523360804421875*^9}, {
   3.52336423246875*^9, 3.52336423984375*^9}, 3.528716608959394*^9, {
   3.5378114879773455`*^9, 3.5378114882175856`*^9}, {3.539014808319905*^9, 
   3.5390148139360275`*^9}, {3.543073943307307*^9, 3.543074019945307*^9}, {
   3.5430740586903067`*^9, 3.543074064726307*^9}, {3.543075246569307*^9, 
   3.5430752470013065`*^9}, {3.5431422985871916`*^9, 3.543142308314192*^9}, {
   3.5439277592067757`*^9, 3.5439277644517756`*^9}, {3.5439278106917753`*^9, 
   3.5439278108357754`*^9}, {3.5551529968463793`*^9, 3.555153041439379*^9}, {
   3.5553255954747143`*^9, 3.555325607990966*^9}, {3.555949225987579*^9, 
   3.5559492261145787`*^9}, 3.763920382649495*^9, {3.766837473854662*^9, 
   3.766837499439719*^9}, {3.7668375300314803`*^9, 3.7668377108155165`*^9}, {
   3.766837749693593*^9, 3.7668378234201884`*^9}, {3.7668383903285275`*^9, 
   3.7668384059285145`*^9}, {3.766925069113969*^9, 3.766925123290484*^9}, {
   3.810465796950551*^9, 3.8104658102624545`*^9}, {3.81046642144578*^9, 
   3.810466497973461*^9}, {3.810466557573217*^9, 3.81046658355416*^9}, {
   3.8104667577464156`*^9, 3.8104667951383114`*^9}, 3.8104682236499877`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Reference", " ", "Configuration"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Position", " ", "Configuration", " ", "of", " ", "Centers", " ", "of", 
    " ", "Mass"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"gst00", " ", "=", " ", 
     RowBox[{"RPToHomogeneous", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", "3", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"-", "lth"}], "-", "rs"}], ",", "0"}], "}"}]}], "]"}]}], 
    ";", "  ", 
    RowBox[{"(*", 
     RowBox[{"shank", " ", "CoM", " ", "pos"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"gst01", " ", "=", " ", 
     RowBox[{"RPToHomogeneous", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", "3", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"-", "rth"}], ",", "0"}], "}"}]}], "]"}]}], ";", "  ", 
    RowBox[{"(*", 
     RowBox[{"thigh", " ", "CoM", " ", "pos"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"gst02", " ", "=", " ", 
     RowBox[{"RPToHomogeneous", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", "3", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "rtor", ",", " ", "0"}], "}"}]}], "]"}]}], ";", 
    "  ", 
    RowBox[{"(*", 
     RowBox[{"torso", " ", "CoM", " ", "pos"}], "*)"}], "\[IndentingNewLine]",
     "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Position", " ", "Configuration", " ", "of", " ", "Joints"}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{"gp0", " ", "=", " ", 
     RowBox[{"RPToHomogeneous", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", "3", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"-", "lth"}], "-", "ls"}], ",", "0"}], "}"}]}], "]"}]}], 
    ";", "  ", 
    RowBox[{"(*", 
     RowBox[{"foot", " ", "pos"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"gp1", " ", "=", " ", 
     RowBox[{"RPToHomogeneous", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", "3", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"-", "lth"}], ",", "0"}], "}"}]}], "]"}]}], ";", "  ", 
    RowBox[{"(*", " ", 
     RowBox[{"knee", " ", "pos"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"gp2", " ", "=", " ", 
     RowBox[{"RPToHomogeneous", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", "3", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", " ", "0"}], "}"}]}], "]"}]}], ";", "  ", 
    RowBox[{"(*", 
     RowBox[{"hip", " ", "pos"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"gp3", " ", "=", " ", 
     RowBox[{"RPToHomogeneous", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", "3", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "ltor", ",", "0"}], "}"}]}], "]"}]}], ";", "  ", 
    RowBox[{"(*", 
     RowBox[{"head", " ", "pos"}], "*)"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Positions", " ", "of", " ", 
      RowBox[{"COM", "'"}], "s"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"gstS1", "=", " ", 
       RowBox[{"e1", ".", "e2", ".", "e3", ".", "e4", ".", "gst00"}]}], ";"}],
      "//", "FullSimplify"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"gstTh1", " ", "=", " ", 
      RowBox[{"e1", ".", "e2", ".", "e3", ".", "gst01"}]}], ";"}], "//", 
    "FullSimplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"gstTor", " ", "=", " ", 
      RowBox[{"e1", ".", "e2", ".", "e7", ".", "gst02"}]}], ";"}], "//", 
    "FullSimplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"gstTh2", " ", "=", " ", 
      RowBox[{"e1", ".", "e2", ".", "e5", ".", "gst01"}]}], ";"}], "//", 
    "FullSimplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"gstS2", " ", "=", " ", 
      RowBox[{
      "e1", ".", "e2", ".", "e3", ".", "e5", ".", "e6", ".", "gst00"}]}], 
     ";"}], "//", "FullSimplify"}]}]}]], "Input",
 CellChangeTimes->{{3.52068675271875*^9, 3.5206868401875*^9}, {
   3.52068688309375*^9, 3.520686884765625*^9}, {3.5206869316875*^9, 
   3.52068695546875*^9}, {3.52068703525*^9, 3.5206870995*^9}, {
   3.52068721059375*^9, 3.5206872309375*^9}, {3.520687329875*^9, 
   3.520687335984375*^9}, {3.520687447921875*^9, 3.520687482640625*^9}, {
   3.52085775021875*^9, 3.5208577569375*^9}, {3.52182002690625*^9, 
   3.521820029890625*^9}, {3.52199454090625*^9, 3.5219945435625*^9}, {
   3.521994576609375*^9, 3.521994577125*^9}, 3.522069407859375*^9, {
   3.52302817175*^9, 3.52302817784375*^9}, {3.52302821046875*^9, 
   3.523028219296875*^9}, {3.52302827453125*^9, 3.523028289421875*^9}, {
   3.52303357528125*^9, 3.523033624796875*^9}, {3.5232999903125*^9, 
   3.523300034796875*^9}, {3.52330072346875*^9, 3.52330075775*^9}, {
   3.5387617592355986`*^9, 3.538761759396615*^9}, {3.5387617916248374`*^9, 
   3.5387617925049257`*^9}, {3.543074082165307*^9, 3.543074148335307*^9}, {
   3.543074210203307*^9, 3.5430743652183065`*^9}, {3.543074567731307*^9, 
   3.543074573234307*^9}, {3.5551530722213793`*^9, 3.555153123128379*^9}, {
   3.5551548714599023`*^9, 3.555154880689748*^9}, {3.7638166935451756`*^9, 
   3.76381674183117*^9}, {3.7639203529556055`*^9, 3.7639203532584653`*^9}, {
   3.766837860997422*^9, 3.76683788583599*^9}, {3.766838103724718*^9, 
   3.7668381441078825`*^9}, {3.7668381826039295`*^9, 
   3.7668383214008665`*^9}, {3.7668387736225224`*^9, 
   3.7668389790774717`*^9}, {3.7668478961501436`*^9, 3.766847912070002*^9}, {
   3.766847992231434*^9, 3.766847996488286*^9}, {3.766848831585499*^9, 
   3.7668488424337807`*^9}, {3.766925134650326*^9, 3.7669251923378916`*^9}, {
   3.771605760149417*^9, 3.7716057788208237`*^9}, {3.777817507892741*^9, 
   3.7778175358224044`*^9}, {3.7778175973821783`*^9, 3.777817685892041*^9}, {
   3.7778177438720217`*^9, 3.777817748821673*^9}, 3.81046581590742*^9, {
   3.8104658474762917`*^9, 3.8104658743262205`*^9}, {3.810465914755995*^9, 
   3.81046593980194*^9}, {3.8104666045630293`*^9, 3.810466763954431*^9}, {
   3.8104668215382032`*^9, 3.8104668449781113`*^9}, {3.810468177003117*^9, 
   3.810468195364052*^9}, 3.81046822923794*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Positions", " ", "of", " ", 
    RowBox[{"Joints", "'"}], "s"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"gpF", "=", " ", 
      RowBox[{
       RowBox[{"e1", ".", "e2", ".", "e3", ".", "e4", ".", "gp0"}], "//", 
       "FullSimplify"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"gpK", "=", " ", 
      RowBox[{
       RowBox[{"e1", ".", "e2", ".", "e3", ".", "gp1"}], "//", 
       "FullSimplify"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"gpH", "=", " ", 
      RowBox[{
       RowBox[{"e1", ".", "e2", ".", "gp2"}], "//", "FullSimplify"}]}], "]"}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"gpK2", " ", "=", " ", 
      RowBox[{
       RowBox[{"e1", ".", "e2", ".", "e5", ".", "gp1"}], "//", 
       "FullSimplify"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"gpF2", " ", "=", " ", 
      RowBox[{
       RowBox[{"e1", ".", "e2", ".", "e5", ".", "e6", ".", "gp0"}], "//", 
       "FullSimplify"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"gpHead", "=", " ", 
      RowBox[{
       RowBox[{"e1", ".", "e2", ".", "e7", ".", "gp3"}], "//", 
       "FullSimplify"}]}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7778177378568373`*^9, 3.777817757691662*^9}, {
  3.8104658815581894`*^9, 3.8104658843581777`*^9}, {3.810466853265046*^9, 
  3.8104669193618183`*^9}, {3.810468263772826*^9, 3.8104682839477835`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"J0", "=", " ", 
   RowBox[{
    RowBox[{"BodyJacobian", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ax1", ",", 
        RowBox[{"x1", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ax2", ",", 
        RowBox[{"x2", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ax3", ",", 
        RowBox[{"x3", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ax4", ",", 
        RowBox[{"x4", "[", "t", "]"}]}], "}"}], "       ", ",", 
      RowBox[{"{", 
       RowBox[{"axzero", ",", 
        RowBox[{"x5", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"axzero", ",", 
        RowBox[{"x6", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"axzero", ",", 
        RowBox[{"x7", "[", "t", "]"}]}], "}"}], " ", ",", "gst00"}], "]"}], "//",
     "FullSimplify"}]}], ";", " ", 
  RowBox[{"(*", 
   RowBox[{"stance", " ", "shank", " ", "COM", " ", "body", " ", "jacobian"}],
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{"J1", "=", " ", 
   RowBox[{
    RowBox[{"BodyJacobian", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ax1", ",", 
        RowBox[{"x1", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ax2", ",", 
        RowBox[{"x2", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ax3", ",", 
        RowBox[{"x3", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"axzero", ",", 
        RowBox[{"x4", "[", "t", "]"}]}], "}"}], " ", ",", 
      RowBox[{"{", 
       RowBox[{"axzero", ",", 
        RowBox[{"x5", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"axzero", ",", 
        RowBox[{"x6", "[", "t", "]"}]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"axzero", ",", 
        RowBox[{"x7", "[", "t", "]"}]}], "}"}], " ", ",", "gst01"}], "]"}], "//",
     "FullSimplify"}]}], ";", " ", 
  RowBox[{"(*", 
   RowBox[{"stance", " ", "thigh", " ", "COM", " ", "body", " ", "jacobian"}],
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{"J2", "=", " ", 
   RowBox[{
    RowBox[{"BodyJacobian", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ax1", ",", 
        RowBox[{"x1", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ax2", ",", 
        RowBox[{"x2", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ax3", ",", 
        RowBox[{"x3", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"axzero", ",", 
        RowBox[{"x4", "[", "t", "]"}]}], "}"}], "  ", ",", 
      RowBox[{"{", 
       RowBox[{"axzero", ",", 
        RowBox[{"x5", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"axzero", ",", 
        RowBox[{"x6", "[", "t", "]"}]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"ax3", ",", 
        RowBox[{"x7", "[", "t", "]"}]}], "}"}], " ", ",", "gst02"}], "]"}], "//",
     "FullSimplify"}]}], ";", 
  RowBox[{"(*", 
   RowBox[{"Torso", " ", "COM", " ", "body", " ", "jacobian"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"J3", "=", " ", 
   RowBox[{
    RowBox[{"BodyJacobian", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ax1", ",", 
        RowBox[{"x1", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ax2", ",", 
        RowBox[{"x2", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"axzero", ",", 
        RowBox[{"x3", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"axzero", ",", 
        RowBox[{"x4", "[", "t", "]"}]}], "}"}], "       ", ",", 
      RowBox[{"{", 
       RowBox[{"ax3", ",", 
        RowBox[{"x5", "[", "t", "]"}]}], "}"}], "       ", ",", 
      RowBox[{"{", 
       RowBox[{"axzero", ",", 
        RowBox[{"x6", "[", "t", "]"}]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"axzero", ",", 
        RowBox[{"x7", "[", "t", "]"}]}], "}"}], " ", ",", "gst01"}], "]"}], "//",
     "FullSimplify"}]}], ";", 
  RowBox[{"(*", 
   RowBox[{"swing", " ", "thigh", " ", "COM", " ", "body", " ", "jacobian"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"J4", "=", " ", 
   RowBox[{
    RowBox[{"BodyJacobian", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ax1", ",", 
        RowBox[{"x1", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ax2", ",", 
        RowBox[{"x2", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"axzero", ",", 
        RowBox[{"x3", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"axzero", ",", 
         RowBox[{"x4", "[", "t", "]"}]}], "}"}], "   ", "     "}], ",", 
      RowBox[{"{", 
       RowBox[{"ax3", ",", 
        RowBox[{"x5", "[", "t", "]"}]}], "}"}], "       ", ",", 
      RowBox[{"{", 
       RowBox[{"ax4", ",", 
        RowBox[{"x6", "[", "t", "]"}]}], "}"}], "       ", ",", 
      RowBox[{"{", 
       RowBox[{"axzero", ",", 
        RowBox[{"x7", "[", "t", "]"}]}], "}"}], " ", ",", " ", "gst00"}], 
     "]"}], "//", "FullSimplify"}]}], ";", " ", 
  RowBox[{"(*", 
   RowBox[{"swing", " ", "shank", " ", "COM", " ", "body", " ", "jacobian"}], 
   "*)"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.5111738617903476`*^9, 3.5111738667576323`*^9}, {
   3.520687517765625*^9, 3.520687540921875*^9}, {3.520687606828125*^9, 
   3.5206876815*^9}, {3.520687776859375*^9, 3.520687825828125*^9}, {
   3.5207672543125*^9, 3.52076725465625*^9}, {3.520857785640625*^9, 
   3.520857819140625*^9}, {3.521820049171875*^9, 3.5218200495*^9}, {
   3.521820085109375*^9, 3.521820108265625*^9}, {3.52191142990625*^9, 
   3.521911483640625*^9}, {3.52199456603125*^9, 3.52199457315625*^9}, {
   3.52302830015625*^9, 3.523028386578125*^9}, {3.523300027125*^9, 
   3.523300057609375*^9}, {3.5430744013273067`*^9, 3.543074418830307*^9}, {
   3.543074460187307*^9, 3.543074460955307*^9}, {3.543074502201307*^9, 
   3.543074505464307*^9}, {3.543074580212307*^9, 3.5430745997753067`*^9}, {
   3.555153147493379*^9, 3.5551532493003793`*^9}, {3.5551548940954285`*^9, 
   3.5551548980572205`*^9}, {3.5553256191800847`*^9, 3.555325646525819*^9}, {
   3.7366939243363523`*^9, 3.7366939259987993`*^9}, 3.7404900754748125`*^9, 
   3.763816558600665*^9, {3.7668383315824933`*^9, 3.766838359803605*^9}, {
   3.7668384106181993`*^9, 3.7668384846168895`*^9}, {3.77220358679504*^9, 
   3.7722036151150627`*^9}, {3.772277585629397*^9, 3.7722777429230676`*^9}, {
   3.7725405153350196`*^9, 3.7725406209760227`*^9}, {3.7725409524353237`*^9, 
   3.7725409628639765`*^9}, {3.7778178042013063`*^9, 3.777817901830901*^9}, {
   3.7779235520178256`*^9, 3.7779235551556787`*^9}, {3.784652112485285*^9, 
   3.7846521431352053`*^9}, 3.784656555238474*^9, {3.7961304260762825`*^9, 
   3.796130431011903*^9}, {3.8104659582308617`*^9, 3.8104660073486595`*^9}, {
   3.8104669526126924`*^9, 3.810467036913356*^9}, {3.8104676959178634`*^9, 
   3.810467701308811*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Velocities", " ", "of", " ", "Joint", " ", "Points"}], ",", " ", 
    RowBox[{"Homogenous", " ", "Coordinates"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"vpF", "=", " ", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"gpF", ",", "t"}], "]"}], "//", "FullSimplify"}]}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"vpK", "=", " ", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"gpK", ",", "t"}], "]"}], "//", "FullSimplify"}]}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"vpH", "=", " ", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"gpH", ",", "t"}], "]"}], "//", "FullSimplify"}]}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"vpK2", "=", " ", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"gpK2", ",", "t"}], "]"}], "//", "FullSimplify"}]}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"MatrixForm", "[", 
    RowBox[{"vpF2", "=", " ", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"gpF2", ",", "t"}], "]"}], "//", "FullSimplify"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.5111738617903476`*^9, 3.5111738667576323`*^9}, {
   3.520687517765625*^9, 3.520687540921875*^9}, {3.520687606828125*^9, 
   3.5206876815*^9}, {3.520687776859375*^9, 3.520687825828125*^9}, {
   3.5207672543125*^9, 3.52076725465625*^9}, {3.520857785640625*^9, 
   3.520857819140625*^9}, {3.521820049171875*^9, 3.5218200495*^9}, {
   3.521820085109375*^9, 3.521820108265625*^9}, {3.52191142990625*^9, 
   3.521911483640625*^9}, {3.52199456603125*^9, 3.52199457315625*^9}, {
   3.52302830015625*^9, 3.523028386578125*^9}, {3.523300027125*^9, 
   3.523300057609375*^9}, {3.5430744013273067`*^9, 3.543074418830307*^9}, {
   3.543074460187307*^9, 3.543074460955307*^9}, {3.543074502201307*^9, 
   3.543074505464307*^9}, {3.543074580212307*^9, 3.5430745997753067`*^9}, {
   3.555153147493379*^9, 3.5551532493003793`*^9}, {3.5551548940954285`*^9, 
   3.5551548980572205`*^9}, {3.5553256191800847`*^9, 3.555325646525819*^9}, {
   3.7366939243363523`*^9, 3.7366939259987993`*^9}, 3.7404900754748125`*^9, 
   3.763816558600665*^9, {3.7668383315824933`*^9, 3.766838359803605*^9}, {
   3.7668384106181993`*^9, 3.7668384846168895`*^9}, {3.77220358679504*^9, 
   3.7722036151150627`*^9}, {3.772277585629397*^9, 3.7722777429230676`*^9}, {
   3.7725405153350196`*^9, 3.7725406209760227`*^9}, {3.7725409524353237`*^9, 
   3.7725409628639765`*^9}, {3.7778178042013063`*^9, 3.777817901830901*^9}, {
   3.7779235520178256`*^9, 3.7779235551556787`*^9}, {3.784652112485285*^9, 
   3.7846521431352053`*^9}, 3.784656555238474*^9, {3.7961304260762825`*^9, 
   3.796130431011903*^9}, {3.8104659582308617`*^9, 3.810466005743634*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"x5", "[", "t", "]"}], "+", 
          RowBox[{"x6", "[", "t", "]"}]}], "]"}]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["x5", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "+", 
         RowBox[{
          SuperscriptBox["x6", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], ")"}]}], 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"x5", "[", "t", "]"}], "+", 
          RowBox[{"x6", "[", "t", "]"}]}], "]"}]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["x5", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "+", 
         RowBox[{
          SuperscriptBox["x6", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], ")"}]}], "0", 
      RowBox[{
       RowBox[{
        SuperscriptBox["x1", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "+", 
       RowBox[{"lth", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"x5", "[", "t", "]"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["x5", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], "+", 
       RowBox[{"ls", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"x5", "[", "t", "]"}], "+", 
          RowBox[{"x6", "[", "t", "]"}]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["x5", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}], "+", 
          RowBox[{
           SuperscriptBox["x6", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}]},
     {
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"x5", "[", "t", "]"}], "+", 
         RowBox[{"x6", "[", "t", "]"}]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["x5", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "+", 
         RowBox[{
          SuperscriptBox["x6", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], ")"}]}], 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"x5", "[", "t", "]"}], "+", 
          RowBox[{"x6", "[", "t", "]"}]}], "]"}]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["x5", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "+", 
         RowBox[{
          SuperscriptBox["x6", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], ")"}]}], "0", 
      RowBox[{
       RowBox[{
        SuperscriptBox["x2", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "+", 
       RowBox[{"lth", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"x5", "[", "t", "]"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["x5", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], "+", 
       RowBox[{"ls", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"x5", "[", "t", "]"}], "+", 
          RowBox[{"x6", "[", "t", "]"}]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["x5", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}], "+", 
          RowBox[{
           SuperscriptBox["x6", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}]},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.810467676326933*^9, 3.810467711064805*^9, 
  3.8104678444853277`*^9, 3.8104685064117527`*^9, 3.810468722692024*^9, 
  3.8104689021694326`*^9, 3.810469053977944*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Joint", " ", "Jacobians"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"Js0", " ", "=", 
     RowBox[{
      RowBox[{"ArrayReshape", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"gpF", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"1", ";;", "2"}], ",", "4"}], "]"}], "]"}], ",", 
          RowBox[{"{", "x", "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "7"}], "}"}]}], "]"}], "//", "FullSimplify"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Js1", " ", "=", 
     RowBox[{
      RowBox[{"ArrayReshape", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"gpK", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"1", ";;", "2"}], ",", "4"}], "]"}], "]"}], ",", 
          RowBox[{"{", "x", "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "7"}], "}"}]}], "]"}], "//", "FullSimplify"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Js2", " ", "=", 
     RowBox[{
      RowBox[{"ArrayReshape", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"gpH", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"1", ";;", "2"}], ",", "4"}], "]"}], "]"}], ",", 
          RowBox[{"{", "x", "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "7"}], "}"}]}], "]"}], "//", "FullSimplify"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Js3", " ", "=", 
     RowBox[{
      RowBox[{"ArrayReshape", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"gpK2", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"1", ";;", "2"}], ",", "4"}], "]"}], "]"}], ",", 
          RowBox[{"{", "x", "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "7"}], "}"}]}], "]"}], "//", "FullSimplify"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Js4", " ", "=", 
     RowBox[{
      RowBox[{"ArrayReshape", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"gpF2", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"1", ";;", "2"}], ",", "4"}], "]"}], "]"}], ",", 
          RowBox[{"{", "x", "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "7"}], "}"}]}], "]"}], "//", "FullSimplify"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.5111738617903476`*^9, 3.5111738667576323`*^9}, {
   3.520687517765625*^9, 3.520687540921875*^9}, {3.520687606828125*^9, 
   3.5206876815*^9}, {3.520687776859375*^9, 3.520687825828125*^9}, {
   3.5207672543125*^9, 3.52076725465625*^9}, {3.520857785640625*^9, 
   3.520857819140625*^9}, {3.521820049171875*^9, 3.5218200495*^9}, {
   3.521820085109375*^9, 3.521820108265625*^9}, {3.52191142990625*^9, 
   3.521911483640625*^9}, {3.52199456603125*^9, 3.52199457315625*^9}, {
   3.52302830015625*^9, 3.523028386578125*^9}, {3.523300027125*^9, 
   3.523300057609375*^9}, {3.5430744013273067`*^9, 3.543074418830307*^9}, {
   3.543074460187307*^9, 3.543074460955307*^9}, {3.543074502201307*^9, 
   3.543074505464307*^9}, {3.543074580212307*^9, 3.5430745997753067`*^9}, {
   3.555153147493379*^9, 3.5551532493003793`*^9}, {3.5551548940954285`*^9, 
   3.5551548980572205`*^9}, {3.5553256191800847`*^9, 3.555325646525819*^9}, {
   3.7366939243363523`*^9, 3.7366939259987993`*^9}, 3.7404900754748125`*^9, 
   3.763816558600665*^9, {3.7668383315824933`*^9, 3.766838359803605*^9}, {
   3.7668384106181993`*^9, 3.7668384846168895`*^9}, {3.77220358679504*^9, 
   3.7722036151150627`*^9}, {3.772277585629397*^9, 3.7722777429230676`*^9}, {
   3.7725405153350196`*^9, 3.7725406209760227`*^9}, {3.7725409524353237`*^9, 
   3.7725409628639765`*^9}, {3.7778178042013063`*^9, 3.777817901830901*^9}, {
   3.7779235520178256`*^9, 3.7779235551556787`*^9}, {3.784652112485285*^9, 
   3.7846521431352053`*^9}, 3.784656555238474*^9, {3.7961304260762825`*^9, 
   3.796130431011903*^9}, {3.8104659582308617`*^9, 3.810466005743634*^9}, {
   3.810467058137296*^9, 3.810467146599906*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Joint", " ", "Jacobians"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"Js0dot", " ", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"Js0", ",", "t"}], "]"}], "//", "FullSimplify"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Js1dot", " ", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"Js1", ",", "t"}], "]"}], "//", "FullSimplify"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Js2dot", " ", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"Js2", ",", "t"}], "]"}], "//", "FullSimplify"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Js3dot", " ", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"Js3", ",", "t"}], "]"}], "//", "FullSimplify"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Js4dot", " ", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"Js4", ",", "t"}], "]"}], "//", "FullSimplify"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8104674562717247`*^9, 3.8104674909746046`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Dynamics", "Section",
 CellChangeTimes->{{3.521995144125*^9, 3.521995144875*^9}, {
   3.526060014172608*^9, 3.5260600152917194`*^9}, {3.543078143146307*^9, 
   3.543078144569307*^9}, 3.5431473723201914`*^9}],

Cell[CellGroupData[{

Cell["Mass Matrix", "Subsubsection",
 CellChangeTimes->{{3.52076884215625*^9, 3.520768850859375*^9}, 
   3.520790829140625*^9, {3.52079098478125*^9, 3.520790985625*^9}, {
   3.763816609462988*^9, 3.7638166458802586`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"genM0", " ", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", " ", 
      RowBox[{"Ms", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "Ms", ",", "0", ",", "0", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", " ", "Ms", ",", "0", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "Isx", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "Isy", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "Isz"}], 
      "}"}]}], "}"}]}], ";", 
  RowBox[{"genM1", " ", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", " ", 
      RowBox[{"Mth", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "Mth", ",", "0", ",", "0", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "Mth", ",", "0", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "Ithx", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "Ithy", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "Ithz"}], 
      "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"genM2", " ", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", " ", 
      RowBox[{"Mtor", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "Mtor", ",", "0", ",", "0", ",", "0", ",", "0"}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", " ", "Mtor", ",", "0", ",", "0", ",", "0"}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "Itorx", ",", "0", ",", "0", ",", "0"}], 
      "}"}], "    ", ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "Itory", ",", "0"}], 
      "}"}], "     ", ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "Itorz"}], 
      "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"genM3", " ", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Mth", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "Mth", ",", "0", ",", "0", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "Mth", ",", "0", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "Ithx", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "Ithy", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "Ithz"}], 
      "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"genM4", " ", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", " ", 
      RowBox[{"Ms", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "Ms", ",", "0", ",", "0", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", " ", "Ms", ",", "0", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "Isx", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "Isy", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "Isz"}], 
      "}"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7638166156113358`*^9, 3.763816620939521*^9}, {
  3.7668385449517975`*^9, 3.7668386580442085`*^9}, {3.8104672339526014`*^9, 
  3.8104672639354534`*^9}, {3.8104684733638673`*^9, 3.8104684969727693`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"MatrixForm", "[", 
  RowBox[{"Mmatrix", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Transpose", "[", "J0", "]"}], ".", "genM0", ".", "J0"}], "+", 
    RowBox[{
     RowBox[{"Transpose", "[", "J1", "]"}], ".", "genM1", ".", "J1"}], "+", 
    RowBox[{
     RowBox[{"Transpose", "[", "J2", "]"}], ".", "genM2", ".", "J2"}], "+", 
    RowBox[{
     RowBox[{"Transpose", "[", "J3", "]"}], ".", "genM3", ".", "J3"}], "+", 
    RowBox[{
     RowBox[{"Transpose", "[", "J4", "]"}], ".", "genM4", ".", "J4"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KE", " ", "=", " ", 
   RowBox[{
    RowBox[{"1", "/", "2"}], "*", 
    RowBox[{
     RowBox[{"Transpose", "[", "xdot", "]"}], ".", "Mmatrix", ".", 
     "xdot"}]}]}], " ", ";"}]}], "Input",
 CellChangeTimes->{{3.7638166156113358`*^9, 3.763816620939521*^9}, {
   3.766839392453774*^9, 3.766839392740121*^9}, {3.7668447646323347`*^9, 
   3.766844766133748*^9}, {3.76685019324174*^9, 3.7668501933860693`*^9}, 
   3.7668502870130854`*^9, 3.7668547114111614`*^9, 3.7669255188766155`*^9, {
   3.810467217694621*^9, 3.8104672261136045`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"Mth", " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", 
          RowBox[{"x3", "[", "t", "]"}], "]"}], "2"]}], "+", 
       RowBox[{"Ms", " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"x3", "[", "t", "]"}], "+", 
           RowBox[{"x4", "[", "t", "]"}]}], "]"}], "2"]}], "+", 
       RowBox[{"Mth", " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", 
          RowBox[{"x5", "[", "t", "]"}], "]"}], "2"]}], "+", 
       RowBox[{"Ms", " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"x5", "[", "t", "]"}], "+", 
           RowBox[{"x6", "[", "t", "]"}]}], "]"}], "2"]}], "+", 
       RowBox[{"Mtor", " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"x3", "[", "t", "]"}], "+", 
           RowBox[{"x7", "[", "t", "]"}]}], "]"}], "2"]}], "+", 
       RowBox[{"Mth", " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", 
          RowBox[{"x3", "[", "t", "]"}], "]"}], "2"]}], "+", 
       RowBox[{"Ms", " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"x3", "[", "t", "]"}], "+", 
           RowBox[{"x4", "[", "t", "]"}]}], "]"}], "2"]}], "+", 
       RowBox[{"Mth", " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", 
          RowBox[{"x5", "[", "t", "]"}], "]"}], "2"]}], "+", 
       RowBox[{"Ms", " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"x5", "[", "t", "]"}], "+", 
           RowBox[{"x6", "[", "t", "]"}]}], "]"}], "2"]}], "+", 
       RowBox[{"Mtor", " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"x3", "[", "t", "]"}], "+", 
           RowBox[{"x7", "[", "t", "]"}]}], "]"}], "2"]}]}], "0", 
      RowBox[{
       RowBox[{"Mth", " ", "rth", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"x3", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"Ms", " ", 
        RowBox[{"(", 
         RowBox[{"rs", "+", 
          RowBox[{"lth", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"x4", "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"x3", "[", "t", "]"}], "+", 
          RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], "-", 
       RowBox[{"Mtor", " ", "rtor", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"x3", "[", "t", "]"}], "+", 
          RowBox[{"x7", "[", "t", "]"}]}], "]"}]}], "+", 
       RowBox[{"lth", " ", "Ms", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"x4", "[", "t", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"x3", "[", "t", "]"}], "+", 
          RowBox[{"x4", "[", "t", "]"}]}], "]"}]}]}], 
      RowBox[{"Ms", " ", "rs", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"x3", "[", "t", "]"}], "+", 
         RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], 
      RowBox[{
       RowBox[{"Mth", " ", "rth", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"x5", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"Ms", " ", 
        RowBox[{"(", 
         RowBox[{"rs", "+", 
          RowBox[{"lth", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"x6", "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"x5", "[", "t", "]"}], "+", 
          RowBox[{"x6", "[", "t", "]"}]}], "]"}]}], "+", 
       RowBox[{"lth", " ", "Ms", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"x6", "[", "t", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"x5", "[", "t", "]"}], "+", 
          RowBox[{"x6", "[", "t", "]"}]}], "]"}]}]}], 
      RowBox[{"Ms", " ", "rs", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"x5", "[", "t", "]"}], "+", 
         RowBox[{"x6", "[", "t", "]"}]}], "]"}]}], 
      RowBox[{
       RowBox[{"-", "Mtor"}], " ", "rtor", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"x3", "[", "t", "]"}], "+", 
         RowBox[{"x7", "[", "t", "]"}]}], "]"}]}]},
     {"0", 
      RowBox[{
       RowBox[{"Mth", " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", 
          RowBox[{"x3", "[", "t", "]"}], "]"}], "2"]}], "+", 
       RowBox[{"Ms", " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"x3", "[", "t", "]"}], "+", 
           RowBox[{"x4", "[", "t", "]"}]}], "]"}], "2"]}], "+", 
       RowBox[{"Mth", " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", 
          RowBox[{"x5", "[", "t", "]"}], "]"}], "2"]}], "+", 
       RowBox[{"Ms", " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"x5", "[", "t", "]"}], "+", 
           RowBox[{"x6", "[", "t", "]"}]}], "]"}], "2"]}], "+", 
       RowBox[{"Mtor", " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"x3", "[", "t", "]"}], "+", 
           RowBox[{"x7", "[", "t", "]"}]}], "]"}], "2"]}], "+", 
       RowBox[{"Mth", " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", 
          RowBox[{"x3", "[", "t", "]"}], "]"}], "2"]}], "+", 
       RowBox[{"Ms", " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"x3", "[", "t", "]"}], "+", 
           RowBox[{"x4", "[", "t", "]"}]}], "]"}], "2"]}], "+", 
       RowBox[{"Mth", " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", 
          RowBox[{"x5", "[", "t", "]"}], "]"}], "2"]}], "+", 
       RowBox[{"Ms", " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"x5", "[", "t", "]"}], "+", 
           RowBox[{"x6", "[", "t", "]"}]}], "]"}], "2"]}], "+", 
       RowBox[{"Mtor", " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"x3", "[", "t", "]"}], "+", 
           RowBox[{"x7", "[", "t", "]"}]}], "]"}], "2"]}]}], 
      RowBox[{
       RowBox[{"Mth", " ", "rth", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"x3", "[", "t", "]"}], "]"}]}], "-", 
       RowBox[{"lth", " ", "Ms", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"x3", "[", "t", "]"}], "+", 
          RowBox[{"x4", "[", "t", "]"}]}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"x4", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"Ms", " ", 
        RowBox[{"(", 
         RowBox[{"rs", "+", 
          RowBox[{"lth", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"x4", "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"x3", "[", "t", "]"}], "+", 
          RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], "-", 
       RowBox[{"Mtor", " ", "rtor", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"x3", "[", "t", "]"}], "+", 
          RowBox[{"x7", "[", "t", "]"}]}], "]"}]}]}], 
      RowBox[{"Ms", " ", "rs", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"x3", "[", "t", "]"}], "+", 
         RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], 
      RowBox[{
       RowBox[{"Mth", " ", "rth", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"x5", "[", "t", "]"}], "]"}]}], "-", 
       RowBox[{"lth", " ", "Ms", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"x5", "[", "t", "]"}], "+", 
          RowBox[{"x6", "[", "t", "]"}]}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"x6", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"Ms", " ", 
        RowBox[{"(", 
         RowBox[{"rs", "+", 
          RowBox[{"lth", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"x6", "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"x5", "[", "t", "]"}], "+", 
          RowBox[{"x6", "[", "t", "]"}]}], "]"}]}]}], 
      RowBox[{"Ms", " ", "rs", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"x5", "[", "t", "]"}], "+", 
         RowBox[{"x6", "[", "t", "]"}]}], "]"}]}], 
      RowBox[{
       RowBox[{"-", "Mtor"}], " ", "rtor", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"x3", "[", "t", "]"}], "+", 
         RowBox[{"x7", "[", "t", "]"}]}], "]"}]}]},
     {
      RowBox[{
       RowBox[{"Mth", " ", "rth", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"x3", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"Ms", " ", 
        RowBox[{"(", 
         RowBox[{"rs", "+", 
          RowBox[{"lth", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"x4", "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"x3", "[", "t", "]"}], "+", 
          RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], "-", 
       RowBox[{"Mtor", " ", "rtor", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"x3", "[", "t", "]"}], "+", 
          RowBox[{"x7", "[", "t", "]"}]}], "]"}]}], "+", 
       RowBox[{"lth", " ", "Ms", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"x4", "[", "t", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"x3", "[", "t", "]"}], "+", 
          RowBox[{"x4", "[", "t", "]"}]}], "]"}]}]}], 
      RowBox[{
       RowBox[{"Mth", " ", "rth", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"x3", "[", "t", "]"}], "]"}]}], "-", 
       RowBox[{"lth", " ", "Ms", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"x3", "[", "t", "]"}], "+", 
          RowBox[{"x4", "[", "t", "]"}]}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"x4", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"Ms", " ", 
        RowBox[{"(", 
         RowBox[{"rs", "+", 
          RowBox[{"lth", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"x4", "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"x3", "[", "t", "]"}], "+", 
          RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], "-", 
       RowBox[{"Mtor", " ", "rtor", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"x3", "[", "t", "]"}], "+", 
          RowBox[{"x7", "[", "t", "]"}]}], "]"}]}]}], 
      RowBox[{"Isz", "+", "Ithz", "+", "Itorz", "+", 
       RowBox[{"Mth", " ", 
        SuperscriptBox["rth", "2"]}], "+", 
       RowBox[{"Mtor", " ", 
        SuperscriptBox["rtor", "2"]}], "+", 
       RowBox[{"Ms", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"rs", "+", 
           RowBox[{"lth", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"x4", "[", "t", "]"}], "]"}]}]}], ")"}], "2"]}], "+", 
       RowBox[{
        SuperscriptBox["lth", "2"], " ", "Ms", " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", 
          RowBox[{"x4", "[", "t", "]"}], "]"}], "2"]}]}], 
      RowBox[{"Isz", "+", 
       RowBox[{"Ms", " ", "rs", " ", 
        RowBox[{"(", 
         RowBox[{"rs", "+", 
          RowBox[{"lth", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"x4", "[", "t", "]"}], "]"}]}]}], ")"}]}]}], "0", "0", 
      RowBox[{"Itorz", "+", 
       RowBox[{"Mtor", " ", 
        SuperscriptBox["rtor", "2"]}]}]},
     {
      RowBox[{"Ms", " ", "rs", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"x3", "[", "t", "]"}], "+", 
         RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], 
      RowBox[{"Ms", " ", "rs", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"x3", "[", "t", "]"}], "+", 
         RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], 
      RowBox[{"Isz", "+", 
       RowBox[{"Ms", " ", "rs", " ", 
        RowBox[{"(", 
         RowBox[{"rs", "+", 
          RowBox[{"lth", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"x4", "[", "t", "]"}], "]"}]}]}], ")"}]}]}], 
      RowBox[{"Isz", "+", 
       RowBox[{"Ms", " ", 
        SuperscriptBox["rs", "2"]}]}], "0", "0", "0"},
     {
      RowBox[{
       RowBox[{"Mth", " ", "rth", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"x5", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"Ms", " ", 
        RowBox[{"(", 
         RowBox[{"rs", "+", 
          RowBox[{"lth", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"x6", "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"x5", "[", "t", "]"}], "+", 
          RowBox[{"x6", "[", "t", "]"}]}], "]"}]}], "+", 
       RowBox[{"lth", " ", "Ms", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"x6", "[", "t", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"x5", "[", "t", "]"}], "+", 
          RowBox[{"x6", "[", "t", "]"}]}], "]"}]}]}], 
      RowBox[{
       RowBox[{"Mth", " ", "rth", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"x5", "[", "t", "]"}], "]"}]}], "-", 
       RowBox[{"lth", " ", "Ms", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"x5", "[", "t", "]"}], "+", 
          RowBox[{"x6", "[", "t", "]"}]}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"x6", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"Ms", " ", 
        RowBox[{"(", 
         RowBox[{"rs", "+", 
          RowBox[{"lth", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"x6", "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"x5", "[", "t", "]"}], "+", 
          RowBox[{"x6", "[", "t", "]"}]}], "]"}]}]}], "0", "0", 
      RowBox[{"Isz", "+", "Ithz", "+", 
       RowBox[{"Mth", " ", 
        SuperscriptBox["rth", "2"]}], "+", 
       RowBox[{"Ms", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"rs", "+", 
           RowBox[{"lth", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"x6", "[", "t", "]"}], "]"}]}]}], ")"}], "2"]}], "+", 
       RowBox[{
        SuperscriptBox["lth", "2"], " ", "Ms", " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", 
          RowBox[{"x6", "[", "t", "]"}], "]"}], "2"]}]}], 
      RowBox[{"Isz", "+", 
       RowBox[{"Ms", " ", "rs", " ", 
        RowBox[{"(", 
         RowBox[{"rs", "+", 
          RowBox[{"lth", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"x6", "[", "t", "]"}], "]"}]}]}], ")"}]}]}], "0"},
     {
      RowBox[{"Ms", " ", "rs", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"x5", "[", "t", "]"}], "+", 
         RowBox[{"x6", "[", "t", "]"}]}], "]"}]}], 
      RowBox[{"Ms", " ", "rs", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"x5", "[", "t", "]"}], "+", 
         RowBox[{"x6", "[", "t", "]"}]}], "]"}]}], "0", "0", 
      RowBox[{"Isz", "+", 
       RowBox[{"Ms", " ", "rs", " ", 
        RowBox[{"(", 
         RowBox[{"rs", "+", 
          RowBox[{"lth", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"x6", "[", "t", "]"}], "]"}]}]}], ")"}]}]}], 
      RowBox[{"Isz", "+", 
       RowBox[{"Ms", " ", 
        SuperscriptBox["rs", "2"]}]}], "0"},
     {
      RowBox[{
       RowBox[{"-", "Mtor"}], " ", "rtor", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"x3", "[", "t", "]"}], "+", 
         RowBox[{"x7", "[", "t", "]"}]}], "]"}]}], 
      RowBox[{
       RowBox[{"-", "Mtor"}], " ", "rtor", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"x3", "[", "t", "]"}], "+", 
         RowBox[{"x7", "[", "t", "]"}]}], "]"}]}], 
      RowBox[{"Itorz", "+", 
       RowBox[{"Mtor", " ", 
        SuperscriptBox["rtor", "2"]}]}], "0", "0", "0", 
      RowBox[{"Itorz", "+", 
       RowBox[{"Mtor", " ", 
        SuperscriptBox["rtor", "2"]}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.7669292766815186`*^9, 3.7669338301964054`*^9, 
  3.766934216714278*^9, 3.7686544185035152`*^9, 3.7693637339879675`*^9, 
  3.7716058198792925`*^9, 3.7716059957032523`*^9, 3.772471053853747*^9, 
  3.77247131949257*^9, 3.7724714492415514`*^9, 3.772541053569152*^9, 
  3.7725418846414843`*^9, 3.776794391892891*^9, 3.777050128735524*^9, 
  3.7779018585867615`*^9, 3.784655466324339*^9, 3.7917382689251947`*^9, 
  3.796130306526899*^9, 3.7961308827450023`*^9, 3.7961318367960997`*^9, 
  3.8091797408057003`*^9, 3.8091809324734907`*^9, 3.8104676768469048`*^9, 
  3.8104677114287724`*^9, 3.8104678448482914`*^9, 3.810468506707746*^9, 
  3.810468723041995*^9, 3.810468902505402*^9, 3.8104690543479404`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["C Matrix", "Subsubsection",
 CellChangeTimes->{{3.52076884215625*^9, 3.520768850859375*^9}, 
   3.520790829140625*^9, {3.52079098478125*^9, 3.520790985625*^9}, {
   3.763816609462988*^9, 3.763816653783472*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Cmtx", "=", 
   RowBox[{"0", "*", 
    RowBox[{"IdentityMatrix", "[", 
     RowBox[{"First", "[", 
      RowBox[{"Dimensions", "[", "x", "]"}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "\[LessEqual]", 
    RowBox[{"First", "[", 
     RowBox[{"Dimensions", "[", "x", "]"}], "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"j", "=", "1"}], ",", 
     RowBox[{"j", "\[LessEqual]", 
      RowBox[{"First", "[", 
       RowBox[{"Dimensions", "[", "x", "]"}], "]"}]}], ",", 
     RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Cmtx", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"FullSimplify", "[", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"Mmatrix", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", "t"}], "]"}], "]"}],
          "+", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"FullSimplify", "[", 
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"Mmatrix", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "k"}], "]"}], "]"}], ",", 
                 RowBox[{"x", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], "]"}], "-", 
              RowBox[{"FullSimplify", "[", 
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"Mmatrix", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "k"}], "]"}], "]"}], ",", 
                 RowBox[{"x", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], "]"}]}], 
             ")"}], " ", 
            RowBox[{"xdot", "[", 
             RowBox[{"[", 
              RowBox[{"k", ",", "1"}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", 
             RowBox[{"First", "[", 
              RowBox[{"Dimensions", "[", "x", "]"}], "]"}]}], "}"}]}], 
          "]"}]}], ")"}]}]}]}], "]"}]}], "]"}], "\n", 
 RowBox[{
  RowBox[{"Cmtx", " ", "=", " ", "Cmtx"}], ";"}]}], "Input",
 CellChangeTimes->{{3.520791335*^9, 3.520791401109375*^9}, {
   3.520791435046875*^9, 3.52079155540625*^9}, {3.520791602453125*^9, 
   3.520791651296875*^9}, {3.5207916853125*^9, 3.520791710046875*^9}, {
   3.520857930671875*^9, 3.520857946375*^9}, {3.521820137609375*^9, 
   3.52182014315625*^9}, {3.52189796709375*^9, 3.521898017515625*^9}, {
   3.523028605546875*^9, 3.52302860590625*^9}, {3.523380346921875*^9, 
   3.52338035309375*^9}, 3.766933766852949*^9, {3.77781755721233*^9, 
   3.777817561682499*^9}, 3.810467220606642*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", "Cmtx", "]"}]], "Input",
 CellChangeTimes->{{3.5207916539375*^9, 3.52079166959375*^9}, {
   3.520857961375*^9, 3.520857962796875*^9}, 3.740490029073041*^9, 
   3.766844233882579*^9, {3.7668447985181684`*^9, 3.7668448046624446`*^9}, 
   3.7668488996676607`*^9, 3.7669255161247463`*^9, 3.766933762391165*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"lth", " ", "Ms"}], "+", 
                RowBox[{"Mth", " ", "rth"}]}], ")"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"x3", "[", "t", "]"}], "]"}]}], "+", 
             RowBox[{"Ms", " ", "rs", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"x3", "[", "t", "]"}], "+", 
                RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], "-", 
             RowBox[{"Mtor", " ", "rtor", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"x3", "[", "t", "]"}], "+", 
                RowBox[{"x7", "[", "t", "]"}]}], "]"}]}]}], ")"}]}], " ", 
          RowBox[{
           SuperscriptBox["x3", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"lth", " ", "Ms"}], "+", 
                RowBox[{"Mth", " ", "rth"}]}], ")"}]}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"x3", "[", "t", "]"}], "]"}]}], "-", 
            RowBox[{"Ms", " ", "rs", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{
               RowBox[{"x3", "[", "t", "]"}], "+", 
               RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], "+", 
            RowBox[{"Mtor", " ", "rtor", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{
               RowBox[{"x3", "[", "t", "]"}], "+", 
               RowBox[{"x7", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
          RowBox[{
           SuperscriptBox["x3", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "-", 
         RowBox[{"2", " ", "Ms", " ", "rs", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x4", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["x4", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "+", 
         RowBox[{"2", " ", "Mtor", " ", "rtor", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x7", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["x7", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "Ms"}], " ", "rs", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x4", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["x3", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "-", 
         RowBox[{"Ms", " ", "rs", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x4", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["x4", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "-", 
         RowBox[{"Ms", " ", "rs", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x4", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["x3", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}], "+", 
            RowBox[{
             SuperscriptBox["x4", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"lth", " ", "Ms"}], "+", 
                RowBox[{"Mth", " ", "rth"}]}], ")"}]}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"x5", "[", "t", "]"}], "]"}]}], "-", 
            RowBox[{"Ms", " ", "rs", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{
               RowBox[{"x5", "[", "t", "]"}], "+", 
               RowBox[{"x6", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
          RowBox[{
           SuperscriptBox["x5", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"lth", " ", "Ms"}], "+", 
               RowBox[{"Mth", " ", "rth"}]}], ")"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"x5", "[", "t", "]"}], "]"}]}], "+", 
            RowBox[{"Ms", " ", "rs", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{
               RowBox[{"x5", "[", "t", "]"}], "+", 
               RowBox[{"x6", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
          RowBox[{
           SuperscriptBox["x5", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "-", 
         RowBox[{"2", " ", "Ms", " ", "rs", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"x5", "[", "t", "]"}], "+", 
            RowBox[{"x6", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["x6", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "Ms"}], " ", "rs", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"x5", "[", "t", "]"}], "+", 
            RowBox[{"x6", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["x5", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "-", 
         RowBox[{"Ms", " ", "rs", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"x5", "[", "t", "]"}], "+", 
            RowBox[{"x6", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["x6", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "-", 
         RowBox[{"Ms", " ", "rs", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"x5", "[", "t", "]"}], "+", 
            RowBox[{"x6", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["x5", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}], "+", 
            RowBox[{
             SuperscriptBox["x6", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Mtor", " ", "rtor", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x7", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["x3", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "+", 
         RowBox[{"Mtor", " ", "rtor", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x7", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["x7", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "+", 
         RowBox[{"Mtor", " ", "rtor", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x7", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["x3", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}], "+", 
            RowBox[{
             SuperscriptBox["x7", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], ")"}]}]},
     {"0", "0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"lth", " ", "Ms"}], "+", 
               RowBox[{"Mth", " ", "rth"}]}], ")"}], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"x3", "[", "t", "]"}], "]"}]}], "+", 
            RowBox[{"Ms", " ", "rs", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               RowBox[{"x3", "[", "t", "]"}], "+", 
               RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], "-", 
            RowBox[{"Mtor", " ", "rtor", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               RowBox[{"x3", "[", "t", "]"}], "+", 
               RowBox[{"x7", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
          RowBox[{
           SuperscriptBox["x3", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "+", 
         RowBox[{"2", " ", "Ms", " ", "rs", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x4", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["x4", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "-", 
         RowBox[{"2", " ", "Mtor", " ", "rtor", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x7", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["x7", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Ms", " ", "rs", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x4", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["x3", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "+", 
         RowBox[{"Ms", " ", "rs", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x4", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["x4", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "+", 
         RowBox[{"Ms", " ", "rs", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x4", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["x3", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}], "+", 
            RowBox[{
             SuperscriptBox["x4", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"lth", " ", "Ms"}], "+", 
               RowBox[{"Mth", " ", "rth"}]}], ")"}], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"x5", "[", "t", "]"}], "]"}]}], "+", 
            RowBox[{"Ms", " ", "rs", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               RowBox[{"x5", "[", "t", "]"}], "+", 
               RowBox[{"x6", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
          RowBox[{
           SuperscriptBox["x5", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "+", 
         RowBox[{"2", " ", "Ms", " ", "rs", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"x5", "[", "t", "]"}], "+", 
            RowBox[{"x6", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["x6", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Ms", " ", "rs", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"x5", "[", "t", "]"}], "+", 
            RowBox[{"x6", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["x5", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "+", 
         RowBox[{"Ms", " ", "rs", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"x5", "[", "t", "]"}], "+", 
            RowBox[{"x6", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["x6", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "+", 
         RowBox[{"Ms", " ", "rs", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"x5", "[", "t", "]"}], "+", 
            RowBox[{"x6", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["x5", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}], "+", 
            RowBox[{
             SuperscriptBox["x6", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "Mtor"}], " ", "rtor", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x7", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["x3", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "-", 
         RowBox[{"Mtor", " ", "rtor", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x7", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["x7", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "-", 
         RowBox[{"Mtor", " ", "rtor", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x7", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["x3", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}], "+", 
            RowBox[{
             SuperscriptBox["x7", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], ")"}]}]},
     {"0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"lth", " ", "Ms"}], "+", 
               RowBox[{"Mth", " ", "rth"}]}], ")"}], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"x3", "[", "t", "]"}], "]"}]}], "+", 
            RowBox[{"Ms", " ", "rs", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               RowBox[{"x3", "[", "t", "]"}], "+", 
               RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], "-", 
            RowBox[{"Mtor", " ", "rtor", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               RowBox[{"x3", "[", "t", "]"}], "+", 
               RowBox[{"x7", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
          RowBox[{
           SuperscriptBox["x3", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"lth", " ", "Ms"}], "+", 
                RowBox[{"Mth", " ", "rth"}]}], ")"}]}], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"x3", "[", "t", "]"}], "]"}]}], "-", 
            RowBox[{"Ms", " ", "rs", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               RowBox[{"x3", "[", "t", "]"}], "+", 
               RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], "+", 
            RowBox[{"Mtor", " ", "rtor", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               RowBox[{"x3", "[", "t", "]"}], "+", 
               RowBox[{"x7", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
          RowBox[{
           SuperscriptBox["x3", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], 
      RowBox[{
       RowBox[{"-", "lth"}], " ", "Ms", " ", "rs", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"x4", "[", "t", "]"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["x4", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "lth", " ", "Ms", " ", "rs", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"x4", "[", "t", "]"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["x3", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "-", 
         RowBox[{"2", " ", "lth", " ", "Ms", " ", "rs", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"x4", "[", "t", "]"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["x4", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], "0", "0", 
      "0"},
     {
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Ms", " ", "rs", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x4", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["x3", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "+", 
         RowBox[{"Ms", " ", "rs", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x4", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["x4", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "-", 
         RowBox[{"Ms", " ", "rs", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x4", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["x3", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}], "+", 
            RowBox[{
             SuperscriptBox["x4", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "Ms"}], " ", "rs", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x4", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["x3", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "-", 
         RowBox[{"Ms", " ", "rs", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x4", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["x4", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "+", 
         RowBox[{"Ms", " ", "rs", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x4", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["x3", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}], "+", 
            RowBox[{
             SuperscriptBox["x4", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], ")"}]}], 
      RowBox[{"lth", " ", "Ms", " ", "rs", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"x4", "[", "t", "]"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["x3", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], "0", "0", "0", "0"},
     {"0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"lth", " ", "Ms"}], "+", 
                RowBox[{"Mth", " ", "rth"}]}], ")"}]}], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"x5", "[", "t", "]"}], "]"}]}], "-", 
            RowBox[{"Ms", " ", "rs", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               RowBox[{"x5", "[", "t", "]"}], "+", 
               RowBox[{"x6", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
          RowBox[{
           SuperscriptBox["x5", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"lth", " ", "Ms"}], "+", 
               RowBox[{"Mth", " ", "rth"}]}], ")"}], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"x5", "[", "t", "]"}], "]"}]}], "+", 
            RowBox[{"Ms", " ", "rs", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               RowBox[{"x5", "[", "t", "]"}], "+", 
               RowBox[{"x6", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
          RowBox[{
           SuperscriptBox["x5", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], "0", "0", 
      RowBox[{
       RowBox[{"-", "lth"}], " ", "Ms", " ", "rs", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"x6", "[", "t", "]"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["x6", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "lth", " ", "Ms", " ", "rs", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"x6", "[", "t", "]"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["x5", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "-", 
         RowBox[{"2", " ", "lth", " ", "Ms", " ", "rs", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"x6", "[", "t", "]"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["x6", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], "0"},
     {
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Ms", " ", "rs", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"x5", "[", "t", "]"}], "+", 
            RowBox[{"x6", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["x5", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "+", 
         RowBox[{"Ms", " ", "rs", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"x5", "[", "t", "]"}], "+", 
            RowBox[{"x6", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["x6", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "-", 
         RowBox[{"Ms", " ", "rs", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"x5", "[", "t", "]"}], "+", 
            RowBox[{"x6", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["x5", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}], "+", 
            RowBox[{
             SuperscriptBox["x6", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "Ms"}], " ", "rs", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"x5", "[", "t", "]"}], "+", 
            RowBox[{"x6", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["x5", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "-", 
         RowBox[{"Ms", " ", "rs", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"x5", "[", "t", "]"}], "+", 
            RowBox[{"x6", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["x6", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "+", 
         RowBox[{"Ms", " ", "rs", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"x5", "[", "t", "]"}], "+", 
            RowBox[{"x6", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["x5", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}], "+", 
            RowBox[{
             SuperscriptBox["x6", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], ")"}]}],
       "0", "0", 
      RowBox[{"lth", " ", "Ms", " ", "rs", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"x6", "[", "t", "]"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["x5", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], "0", "0"},
     {
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "Mtor"}], " ", "rtor", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x7", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["x3", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "-", 
         RowBox[{"Mtor", " ", "rtor", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x7", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["x7", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "+", 
         RowBox[{"Mtor", " ", "rtor", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x7", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["x3", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}], "+", 
            RowBox[{
             SuperscriptBox["x7", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Mtor", " ", "rtor", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x7", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["x3", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "+", 
         RowBox[{"Mtor", " ", "rtor", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x7", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["x7", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "-", 
         RowBox[{"Mtor", " ", "rtor", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x7", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["x3", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}], "+", 
            RowBox[{
             SuperscriptBox["x7", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], ")"}]}],
       "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.766929613808268*^9, 3.7669340197500277`*^9, 
  3.7669343594172645`*^9, 3.7686545720518184`*^9, 3.7693638849649754`*^9, 
  3.7716062516114573`*^9, 3.7724717315754666`*^9, 3.7725413568276863`*^9, 
  3.777050440078888*^9, 3.7779021531668715`*^9, 3.7917385600198107`*^9, 
  3.796131197107332*^9, 3.7961321319102564`*^9, 3.8104677132697945`*^9, 
  3.81046784632129*^9, 3.810468508297744*^9, 3.81046872471099*^9, 
  3.8104689041723957`*^9, 3.8104690560579348`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Gravity", "Subsubsection",
 CellChangeTimes->{{3.7639204805204716`*^9, 3.763920481544552*^9}, 
   3.76684801883489*^9, {3.7668489333256397`*^9, 3.7668489356007504`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PE", " ", "=", "  ", 
    RowBox[{
     RowBox[{"Ms", "*", "g", "*", 
      RowBox[{"gstS1", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "4"}], "]"}], "]"}]}], "+", 
     RowBox[{"Mth", "*", "g", "*", 
      RowBox[{"gstTh1", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "4"}], "]"}], "]"}]}], "+", 
     RowBox[{"Mtor", "*", "g", "*", 
      RowBox[{"gstTor", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "4"}], "]"}], "]"}]}], "+", 
     RowBox[{"Mth", "*", "g", "*", 
      RowBox[{"gstTh2", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "4"}], "]"}], "]"}]}], "+", 
     RowBox[{"Ms", "*", "g", "*", 
      RowBox[{"gstS2", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "4"}], "]"}], "]"}]}]}]}], ";"}], " ", "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Nvect", " ", "=", " ", 
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{"D", "[", 
       RowBox[{"PE", ",", 
        RowBox[{"Transpose", "[", "x", "]"}]}], "]"}], "}"}], "]"}]}], ";"}], 
  " ", "//", "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "Nvect", "]"}]}], "Input",
 CellChangeTimes->{{3.7668500685384293`*^9, 3.766850128622355*^9}, {
   3.7668501669474573`*^9, 3.7668501891299787`*^9}, {3.766925222079686*^9, 
   3.7669252297190833`*^9}, 3.766925513805091*^9, 3.766933727203929*^9, {
   3.777292056939675*^9, 3.7772921176770496`*^9}, {3.7772922522028837`*^9, 
   3.77729225843517*^9}, {3.7778162496272836`*^9, 3.7778162594774046`*^9}, {
   3.7778162910166736`*^9, 3.7778162926171045`*^9}, 3.777816957324311*^9, {
   3.7778174643026085`*^9, 3.7778174650926857`*^9}, {3.7778177049897127`*^9, 
   3.777817720646925*^9}, {3.8104673040193424`*^9, 3.8104673238242283`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0"},
     {
      RowBox[{
       RowBox[{"2", " ", "g", " ", "Ms"}], "+", 
       RowBox[{"2", " ", "g", " ", "Mth"}], "+", 
       RowBox[{"g", " ", "Mtor"}]}]},
     {
      RowBox[{
       RowBox[{"g", " ", "Mth", " ", "rth", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"x3", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"g", " ", "Ms", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"lth", " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"Cos", "[", 
              RowBox[{"x4", "[", "t", "]"}], "]"}]}], ")"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"x3", "[", "t", "]"}], "]"}]}], "-", 
          RowBox[{"lth", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"x3", "[", "t", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"x4", "[", "t", "]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "lth"}], "-", "rs"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               RowBox[{"Cos", "[", 
                RowBox[{"x4", "[", "t", "]"}], "]"}]}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"x3", "[", "t", "]"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{"x3", "[", "t", "]"}], "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"x4", "[", "t", "]"}], "]"}]}]}], ")"}]}]}], ")"}]}], 
       "+", 
       RowBox[{"g", " ", "Ms", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "lth"}], " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"Cos", "[", 
              RowBox[{"x6", "[", "t", "]"}], "]"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               RowBox[{"Cos", "[", 
                RowBox[{"x5", "[", "t", "]"}], "]"}]}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"x3", "[", "t", "]"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{"x3", "[", "t", "]"}], "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"x5", "[", "t", "]"}], "]"}]}]}], ")"}]}], "-", 
          RowBox[{"lth", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{"x3", "[", "t", "]"}], "]"}], " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"x5", "[", "t", "]"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"Sin", "[", 
               RowBox[{"x3", "[", "t", "]"}], "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"x5", "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"x6", "[", "t", "]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "lth"}], "-", "rs"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{"x6", "[", "t", "]"}], "]"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"Cos", "[", 
                   RowBox[{"x5", "[", "t", "]"}], "]"}]}], " ", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"x3", "[", "t", "]"}], "]"}]}], "-", 
                RowBox[{
                 RowBox[{"Cos", "[", 
                  RowBox[{"x3", "[", "t", "]"}], "]"}], " ", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"x5", "[", "t", "]"}], "]"}]}]}], ")"}]}], "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Cos", "[", 
                  RowBox[{"x3", "[", "t", "]"}], "]"}], " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"x5", "[", "t", "]"}], "]"}]}], "-", 
                RowBox[{
                 RowBox[{"Sin", "[", 
                  RowBox[{"x3", "[", "t", "]"}], "]"}], " ", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"x5", "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"x6", "[", "t", "]"}], "]"}]}]}], ")"}]}]}], ")"}]}]}]},
     {
      RowBox[{"g", " ", "Ms", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "lth"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"x4", "[", "t", "]"}], "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"x3", "[", "t", "]"}], "]"}]}], "-", 
         RowBox[{"lth", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"x3", "[", "t", "]"}], "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"x4", "[", "t", "]"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "lth"}], "-", "rs"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Cos", "[", 
               RowBox[{"x4", "[", "t", "]"}], "]"}]}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"x3", "[", "t", "]"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"x3", "[", "t", "]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"x4", "[", "t", "]"}], "]"}]}]}], ")"}]}]}], ")"}]}]},
     {
      RowBox[{
       RowBox[{"g", " ", "Mth", " ", "rth", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"x5", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"g", " ", "Ms", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "lth"}], " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"Cos", "[", 
              RowBox[{"x6", "[", "t", "]"}], "]"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               RowBox[{"Cos", "[", 
                RowBox[{"x5", "[", "t", "]"}], "]"}]}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"x3", "[", "t", "]"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{"x3", "[", "t", "]"}], "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"x5", "[", "t", "]"}], "]"}]}]}], ")"}]}], "-", 
          RowBox[{"lth", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{"x3", "[", "t", "]"}], "]"}], " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"x5", "[", "t", "]"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"Sin", "[", 
               RowBox[{"x3", "[", "t", "]"}], "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"x5", "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"x6", "[", "t", "]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "lth"}], "-", "rs"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{"x6", "[", "t", "]"}], "]"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"Cos", "[", 
                   RowBox[{"x5", "[", "t", "]"}], "]"}]}], " ", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"x3", "[", "t", "]"}], "]"}]}], "-", 
                RowBox[{
                 RowBox[{"Cos", "[", 
                  RowBox[{"x3", "[", "t", "]"}], "]"}], " ", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"x5", "[", "t", "]"}], "]"}]}]}], ")"}]}], "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Cos", "[", 
                  RowBox[{"x3", "[", "t", "]"}], "]"}], " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"x5", "[", "t", "]"}], "]"}]}], "-", 
                RowBox[{
                 RowBox[{"Sin", "[", 
                  RowBox[{"x3", "[", "t", "]"}], "]"}], " ", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"x5", "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"x6", "[", "t", "]"}], "]"}]}]}], ")"}]}]}], ")"}]}]}]},
     {
      RowBox[{"g", " ", "Ms", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "lth"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"x6", "[", "t", "]"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"x5", "[", "t", "]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"x3", "[", "t", "]"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"x3", "[", "t", "]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"x5", "[", "t", "]"}], "]"}]}]}], ")"}]}], "-", 
         RowBox[{"lth", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"x3", "[", "t", "]"}], "]"}], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"x5", "[", "t", "]"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"x3", "[", "t", "]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"x5", "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"x6", "[", "t", "]"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "lth"}], "-", "rs"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Cos", "[", 
               RowBox[{"x6", "[", "t", "]"}], "]"}]}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{"x5", "[", "t", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"x3", "[", "t", "]"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{"x3", "[", "t", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"x5", "[", "t", "]"}], "]"}]}]}], ")"}]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{"x3", "[", "t", "]"}], "]"}], " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"x5", "[", "t", "]"}], "]"}]}], "-", 
               RowBox[{
                RowBox[{"Sin", "[", 
                 RowBox[{"x3", "[", "t", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"x5", "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"x6", "[", "t", "]"}], "]"}]}]}], ")"}]}]}], ")"}]}]},
     {
      RowBox[{
       RowBox[{"-", "g"}], " ", "Mtor", " ", "rtor", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"x7", "[", "t", "]"}], "]"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.766929614982893*^9, {3.7669296697136307`*^9, 3.7669296830397396`*^9}, 
   3.7669340206956215`*^9, 3.7669343605193305`*^9, 3.7686545732654533`*^9, 
   3.769363885982718*^9, 3.771606253551503*^9, 3.772471733310014*^9, 
   3.772541358777351*^9, 3.777050442286249*^9, 3.7779021532745523`*^9, 
   3.7917385601378107`*^9, 3.7961311971822987`*^9, 3.7961321319642267`*^9, 
   3.8104677133237667`*^9, 3.8104678463843184`*^9, 3.810468508351715*^9, 
   3.8104687247770157`*^9, 3.810468904233423*^9, 3.8104690561029377`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[Cell["More Dynamics", "Section",
  CellChangeTimes->{{3.521995144125*^9, 3.521995144875*^9}, {
    3.526060014172608*^9, 3.5260600152917194`*^9}, {3.543078143146307*^9, 
    3.543078144569307*^9}, 3.5431473723201914`*^9}]], "Input",
 CellChangeTimes->{{3.7961314931579237`*^9, 
  3.796131511260792*^9}}]], "Section",
 CellChangeTimes->{3.796131565725744*^9}],

Cell[CellGroupData[{

Cell["Center of Mass", "Subsubsection",
 CellChangeTimes->{{3.52076884215625*^9, 3.520768850859375*^9}, 
   3.520790829140625*^9, {3.52079098478125*^9, 3.520790985625*^9}, {
   3.763816609462988*^9, 3.763816653783472*^9}, {3.7668481265350714`*^9, 
   3.7668481477981267`*^9}, {3.7668506621499777`*^9, 3.7668506628399115`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Mtotal", " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", "*", "Ms"}], "+", 
     RowBox[{"2", "*", "Mth"}], "+", "Mtor"}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"COM", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"gstS1", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"1", ";;", "2"}], ",", "4"}], "]"}], "]"}], "*", "Ms"}], 
      "+", 
      RowBox[{
       RowBox[{"gstTh1", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"1", ";;", "2"}], ",", "4"}], "]"}], "]"}], "*", "Mth"}], 
      "+", " ", 
      RowBox[{
       RowBox[{"gstTor", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"1", ";;", "2"}], ",", "4"}], "]"}], "]"}], "*", "Mtor"}], 
      "+", " ", 
      RowBox[{
       RowBox[{"gstTh2", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"1", ";;", "2"}], ",", "4"}], "]"}], "]"}], "*", "Mth"}], 
      "+", 
      RowBox[{
       RowBox[{"gstS2", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"1", ";;", "2"}], ",", "4"}], "]"}], "]"}], "*", "Ms"}]}], 
     ")"}], "/", "Mtotal"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dCOM", " ", "=", " ", 
    RowBox[{"D", "[", 
     RowBox[{"COM", ",", "t"}], "]"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ddCOM", " ", "=", " ", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"COM", ",", "t"}], "]"}], ",", "t"}], "]"}]}], ";"}], 
  " "}]}], "Input",
 CellChangeTimes->{{3.7668486252840843`*^9, 3.7668486490930033`*^9}, {
   3.766848680163347*^9, 3.7668487722907896`*^9}, {3.7668489204997654`*^9, 
   3.766848972164424*^9}, {3.766849327582846*^9, 3.766849486239126*^9}, {
   3.766849539920843*^9, 3.7668496591355314`*^9}, {3.766849691133127*^9, 
   3.766849794955684*^9}, {3.766849838815553*^9, 3.7668498753572845`*^9}, 
   3.7668502773152695`*^9, {3.766850657609066*^9, 3.7668506580725536`*^9}, 
   3.7668520771706724`*^9, {3.76685459667849*^9, 3.766854599331273*^9}, 
   3.7779017633905935`*^9, {3.8104671776817827`*^9, 3.8104671799527845`*^9}, {
   3.8104673362061825`*^9, 3.8104673771360645`*^9}, {3.8104676152941704`*^9, 
   3.81046763294308*^9}, 3.810469037851976*^9}]
}, Open  ]],

Cell["VHC", "Subsubsection",
 CellChangeTimes->{{3.52076884215625*^9, 3.520768850859375*^9}, 
   3.520790829140625*^9, {3.52079098478125*^9, 3.520790985625*^9}, {
   3.763816609462988*^9, 3.763816653783472*^9}, {3.7668481265350714`*^9, 
   3.7668481477981267`*^9}, {3.766850517290866*^9, 3.7668505243431225`*^9}, {
   3.7668507239896917`*^9, 3.7668507266940975`*^9}, {3.791735741230921*^9, 
   3.791735745946871*^9}}],

Cell[CellGroupData[{

Cell["Inter-Leg Spring, SLIP", "Subsubsection",
 CellChangeTimes->{{3.52076884215625*^9, 3.520768850859375*^9}, 
   3.520790829140625*^9, {3.52079098478125*^9, 3.520790985625*^9}, {
   3.763816609462988*^9, 3.763816653783472*^9}, {3.7668481265350714`*^9, 
   3.7668481477981267`*^9}, {3.766850517290866*^9, 3.7668505243431225`*^9}, {
   3.7668507239896917`*^9, 3.7668507266940975`*^9}, {3.791735741230921*^9, 
   3.791735745946871*^9}, {3.797339473131629*^9, 3.7973394845387015`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"L1vec", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"pH", "-", "pF1"}], " ", "//", 
     RowBox[{"FullSimplify", "\[IndentingNewLine]", "L2vec"}]}], " ", "=", 
    " ", 
    RowBox[{
     RowBox[{
      RowBox[{"pH", "-", "pF2"}], " ", "//", 
      RowBox[{"FullSimplify", "\[IndentingNewLine]", "z"}]}], " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"FullSimplify", "[", 
        RowBox[{
         RowBox[{"VectorAngle", "[", 
          RowBox[{"L1vec", ",", "L2vec"}], "]"}], ",", 
         RowBox[{"L1vec", "\[Element]", "Reals"}]}], "]"}], 
       "\[IndentingNewLine]", "zdot"}], " ", "=", " ", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"z", ",", "t"}], "]"}], "//", 
       RowBox[{"FullSimplify", "\[IndentingNewLine]", 
        RowBox[{"MatrixForm", "[", 
         RowBox[{"zJacob", "=", " ", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{"D", "[", 
              RowBox[{"z", ",", 
               RowBox[{"Transpose", "[", "x", "]"}]}], "]"}], "}"}], "]"}], "//",
            "FullSimplify"}]}], "]"}]}]}]}]}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.797339529827429*^9, 3.797339602826997*^9}, {
   3.797339716707759*^9, 3.797339723499915*^9}, {3.797340518373462*^9, 
   3.797340555044411*^9}, {3.7973411666929264`*^9, 3.797341217054143*^9}, {
   3.797341400253563*^9, 3.797341401021137*^9}, {3.7973418588059235`*^9, 
   3.7973418599657316`*^9}, {3.797341899613937*^9, 3.7973419131176977`*^9}, 
   3.810467399478958*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Export", "Section",
 CellChangeTimes->{{3.511177531124222*^9, 3.511177531860264*^9}}],

Cell[BoxData[{
 RowBox[{"Clear", "[", "x", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dim", "=", "7"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"x1", "[", "t", "]"}], ":=", 
     RowBox[{"x", "[", "1", "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{"x2", "[", "t", "]"}], ":=", 
     RowBox[{"x", "[", "2", "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{"x3", "[", "t", "]"}], ":=", 
     RowBox[{"x", "[", "3", "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{"x4", "[", "t", "]"}], ":=", 
     RowBox[{"x", "[", "4", "]"}]}], ",", 
    RowBox[{
     RowBox[{"x5", "[", "t", "]"}], ":=", 
     RowBox[{"x", "[", "5", "]"}]}], ",", 
    RowBox[{
     RowBox[{"x6", "[", "t", "]"}], ":=", 
     RowBox[{"x", "[", "6", "]"}]}], ",", 
    RowBox[{
     RowBox[{"x7", "[", "t", "]"}], ":=", 
     RowBox[{"x", "[", "7", "]"}]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"x1", "'"}], "[", "t", "]"}], ":=", 
     RowBox[{"x", "[", 
      RowBox[{"dim", "+", "1"}], "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"x2", "'"}], "[", "t", "]"}], ":=", 
     RowBox[{"x", "[", 
      RowBox[{"dim", "+", "2"}], "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"x3", "'"}], "[", "t", "]"}], ":=", 
     RowBox[{"x", "[", 
      RowBox[{"dim", "+", "3"}], "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"x4", "'"}], "[", "t", "]"}], ":=", 
     RowBox[{"x", "[", 
      RowBox[{"dim", "+", "4"}], "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"x5", "'"}], "[", "t", "]"}], ":=", 
     RowBox[{"x", "[", 
      RowBox[{"dim", "+", "5"}], "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"x6", "'"}], "[", "t", "]"}], ":=", 
     RowBox[{"x", "[", 
      RowBox[{"dim", "+", "6"}], "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"x7", "'"}], "[", "t", "]"}], ":=", 
     RowBox[{"x", "[", 
      RowBox[{"dim", "+", "7"}], "]"}]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"x1", "''"}], "[", "t", "]"}], ":=", 
     RowBox[{"a", "[", "1", "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"x2", "''"}], "[", "t", "]"}], ":=", 
     RowBox[{"a", "[", "2", "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"x3", "''"}], "[", "t", "]"}], ":=", 
     RowBox[{"a", "[", "3", "]"}]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"x4", "''"}], "[", "t", "]"}], ":=", 
     RowBox[{"a", "[", "4", "]"}]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"x5", "''"}], "[", "t", "]"}], ":=", 
     RowBox[{"a", "[", "5", "]"}]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"x6", "''"}], "[", "t", "]"}], ":=", 
     RowBox[{"a", "[", "6", "]"}]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"x7", "''"}], "[", "t", "]"}], ":=", 
     RowBox[{"a", "[", "7", "]"}]}]}], "}"}], ";"}]}], "Input",
 CellChangeTimes->{{3.523274663953125*^9, 3.5232746810625*^9}, {
   3.52327495384375*^9, 3.5232750456875*^9}, {3.5232901581875*^9, 
   3.523290214203125*^9}, {3.523380407609375*^9, 3.52338042590625*^9}, {
   3.523380594984375*^9, 3.523380620390625*^9}, {3.538749586056141*^9, 
   3.5387495922311406`*^9}, {3.538835825326691*^9, 3.538835847437691*^9}, {
   3.5431437314051914`*^9, 3.5431437394361916`*^9}, {3.543928827586776*^9, 
   3.5439288325927753`*^9}, {3.5550941946856728`*^9, 
   3.5550942017716727`*^9}, {3.5550942703126726`*^9, 3.555094363648673*^9}, {
   3.555178321819333*^9, 3.555178343561333*^9}, {3.5551783963133335`*^9, 
   3.5551784047093334`*^9}, {3.5553271072898808`*^9, 3.55532714308346*^9}, {
   3.5558698844658337`*^9, 3.5558698887528334`*^9}, {3.5558699258888335`*^9, 
   3.5558699260948334`*^9}, 3.7404899945838785`*^9, 3.763985685557726*^9, {
   3.766839059428672*^9, 3.7668390599897084`*^9}, 3.7668476276088934`*^9, {
   3.766855781789193*^9, 3.7668557985722*^9}, {3.7668571709820786`*^9, 
   3.766857216438575*^9}, {3.7668578392979937`*^9, 3.766857879684413*^9}, {
   3.7778168024551315`*^9, 3.777816803045433*^9}, {3.7778174695229225`*^9, 
   3.77781746976779*^9}, {3.777817949380939*^9, 3.777817958461069*^9}, {
   3.8104686756581945`*^9, 3.8104687104430494`*^9}, {3.8104688653895383`*^9, 
   3.810468890587446*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"toplevelfolder", " ", "=", " ", 
   RowBox[{"ParentDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"configfolder", "=", " ", "\"\<\\\\ToMatlabOutputs\\\\\>\""}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7668473967462254`*^9, 3.7668474024564037`*^9}, {
   3.7668474695593543`*^9, 3.7668474697558975`*^9}, {3.766847784087072*^9, 
   3.7668478419757366`*^9}, {3.7668480710616474`*^9, 3.766848091110597*^9}, {
   3.7668504617836914`*^9, 3.7668504802969027`*^9}, {3.7668506719744034`*^9, 
   3.766850685815195*^9}, {3.766853071465933*^9, 3.7668530716932955`*^9}, {
   3.7668531185865545`*^9, 3.7668531205381513`*^9}, {3.7668533695450726`*^9, 
   3.766853390729023*^9}, {3.7668540747274265`*^9, 3.7668540786947384`*^9}, {
   3.766854399462119*^9, 3.766854477603095*^9}, 3.7668545798447995`*^9, {
   3.766854952258715*^9, 3.766854973488822*^9}, {3.766855039073496*^9, 
   3.766855052017766*^9}, {3.7686547375662546`*^9, 3.7686547427169833`*^9}, {
   3.771605832033862*^9, 3.771605839537809*^9}, {3.772277780441394*^9, 
   3.772277856473636*^9}, {3.772279549692916*^9, 3.7722795606940947`*^9}, {
   3.7722796223555145`*^9, 3.772279622675598*^9}, 3.772279923053319*^9, {
   3.772280051875898*^9, 3.7722800532501335`*^9}, 3.7724712823764505`*^9, {
   3.772544319812922*^9, 3.7725443260688457`*^9}, {3.7778180168305063`*^9, 
   3.777818063490815*^9}, {3.7778183190733128`*^9, 3.7778183490397363`*^9}, {
   3.7778185165591946`*^9, 3.7778185469889517`*^9}, {3.777901679193923*^9, 
   3.7779017110013313`*^9}, {3.777902180651893*^9, 3.7779021807915163`*^9}, {
   3.777902374229483*^9, 3.7779023749006786`*^9}, {3.7779186193079967`*^9, 
   3.77791861948753*^9}, 3.7794519431219034`*^9, {3.784655951448574*^9, 
   3.7846559537345686`*^9}, {3.796131683014146*^9, 3.7961316863472157`*^9}, {
   3.8104675167825127`*^9, 3.8104675797743053`*^9}, {3.8104678311363497`*^9, 
   3.810467834572338*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"write", " ", "kinematic", " ", "functions"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"folder", " ", "=", " ", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
      "toplevelfolder", ",", "configfolder", ",", 
       "\"\<KinematicFunctions\\\\\>\""}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"dirname", "=", "folder"}], "}"}], ",", 
     RowBox[{"Switch", "[", 
      RowBox[{
       RowBox[{"FileType", "[", "dirname", "]"}], ",", "None", ",", 
       RowBox[{"CreateDirectory", "[", "dirname", "]"}], " ", 
       RowBox[{"(*", 
        RowBox[{"create", " ", "dir"}], "*)"}], ",", "Directory", ",", "Null",
        " ", 
       RowBox[{"(*", 
        RowBox[{"do", " ", "nothing"}], "*)"}], ",", "File", ",", 
       RowBox[{
       "Print", "[", "\"\<File with same name already exists!!\>\"", "]"}]}], 
      " ", 
      RowBox[{"(*", 
       RowBox[{"error", "!"}], "*)"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"WriteMatlab", "[", 
    RowBox[{"gpF", ",", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"folder", ",", "\"\<Foot_st_pos.m\>\""}], "]"}], ",", 
     "posFst"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"WriteMatlab", "[", 
    RowBox[{"gpK", ",", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"folder", ",", "\"\<Knee_st_pos.m\>\""}], "]"}], ",", 
     "posKst"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"WriteMatlab", "[", 
    RowBox[{"gpH", ",", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"folder", ",", "\"\<Hip_pos.m\>\""}], "]"}], ",", "posH"}], 
    "]"}], "\[IndentingNewLine]", 
   RowBox[{"WriteMatlab", "[", 
    RowBox[{"gpK2", ",", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"folder", ",", "\"\<Knee_sw_pos.m\>\""}], "]"}], ",", 
     "posKsw"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"WriteMatlab", "[", 
    RowBox[{"gpF2", ",", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"folder", ",", "\"\<Foot_sw_pos.m\>\""}], "]"}], ",", 
     "posFsw"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"WriteMatlab", "[", 
    RowBox[{"gpHead", ",", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"folder", ",", "\"\<Head_pos.m\>\""}], "]"}], ",", "posHead"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7668473967462254`*^9, 3.7668474024564037`*^9}, {
   3.7668474695593543`*^9, 3.7668474697558975`*^9}, {3.766847784087072*^9, 
   3.7668478419757366`*^9}, {3.7668480710616474`*^9, 3.766848091110597*^9}, {
   3.7668504617836914`*^9, 3.7668504802969027`*^9}, {3.7668506719744034`*^9, 
   3.766850685815195*^9}, {3.766853071465933*^9, 3.7668530716932955`*^9}, {
   3.7668531185865545`*^9, 3.7668531205381513`*^9}, {3.7668533695450726`*^9, 
   3.766853390729023*^9}, {3.7668540747274265`*^9, 3.7668540786947384`*^9}, {
   3.766854399462119*^9, 3.766854477603095*^9}, 3.7668545798447995`*^9, {
   3.766854952258715*^9, 3.766854973488822*^9}, {3.766855039073496*^9, 
   3.766855052017766*^9}, {3.7686547375662546`*^9, 3.7686547427169833`*^9}, {
   3.771605832033862*^9, 3.771605839537809*^9}, {3.772277780441394*^9, 
   3.772277856473636*^9}, {3.772279549692916*^9, 3.7722795606940947`*^9}, {
   3.7722796223555145`*^9, 3.772279622675598*^9}, 3.772279923053319*^9, {
   3.7725441926935205`*^9, 3.772544235537221*^9}, 3.77781796835398*^9, {
   3.7778183470696664`*^9, 3.777818352019532*^9}, {3.777818551118823*^9, 
   3.7778185530189786`*^9}, {3.7779022711896954`*^9, 3.777902271430052*^9}, {
   3.7779023029510117`*^9, 3.7779023267423706`*^9}, {3.7961323393484125`*^9, 
   3.796132348724479*^9}, {3.797342017757595*^9, 3.7973420990777793`*^9}, {
   3.8104675866552515`*^9, 3.8104675871032467`*^9}, {3.8104683017107162`*^9, 
   3.810468332396618*^9}}],

Cell[BoxData[{
 RowBox[{"WriteMatlab", "[", 
  RowBox[{"vpF", ",", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"folder", ",", "\"\<Foot_st_vel.m\>\""}], "]"}], ",", "velFst"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"WriteMatlab", "[", 
  RowBox[{"vpK", ",", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"folder", ",", "\"\<Knee_st_vel.m\>\""}], "]"}], ",", "velKst"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"WriteMatlab", "[", 
  RowBox[{"vpH", ",", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"folder", ",", "\"\<Hip_vel.m\>\""}], "]"}], ",", "velH"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"WriteMatlab", "[", 
  RowBox[{"vpK2", ",", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"folder", ",", "\"\<Knee_sw_vel.m\>\""}], "]"}], ",", "velKsw"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"WriteMatlab", "[", 
  RowBox[{"vpF2", ",", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"folder", ",", "\"\<Foot_sw_vel.m\>\""}], "]"}], ",", "velFsw"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.7668473967462254`*^9, 3.7668474024564037`*^9}, {
   3.7668474695593543`*^9, 3.7668474697558975`*^9}, {3.766847784087072*^9, 
   3.7668478419757366`*^9}, {3.7668480710616474`*^9, 3.766848091110597*^9}, {
   3.7668504617836914`*^9, 3.7668504802969027`*^9}, {3.7668506719744034`*^9, 
   3.766850685815195*^9}, {3.766853071465933*^9, 3.7668530716932955`*^9}, {
   3.7668531185865545`*^9, 3.7668531205381513`*^9}, {3.7668533695450726`*^9, 
   3.766853390729023*^9}, {3.7668540747274265`*^9, 3.7668540786947384`*^9}, {
   3.766854399462119*^9, 3.766854477603095*^9}, 3.7668545798447995`*^9, {
   3.766854952258715*^9, 3.766854973488822*^9}, {3.766855039073496*^9, 
   3.766855052017766*^9}, {3.7686547375662546`*^9, 3.7686547427169833`*^9}, {
   3.771605832033862*^9, 3.771605839537809*^9}, {3.772277780441394*^9, 
   3.772277856473636*^9}, {3.772279549692916*^9, 3.7722795606940947`*^9}, {
   3.7722796223555145`*^9, 3.772279622675598*^9}, 3.772279923053319*^9, {
   3.7725441926935205`*^9, 3.772544235537221*^9}, {3.772548722806535*^9, 
   3.77254872383126*^9}, {3.7973421051570544`*^9, 3.797342114405057*^9}, {
   3.797342225197318*^9, 3.7973422256140714`*^9}, {3.81046759076527*^9, 
   3.810467591055235*^9}}],

Cell[BoxData[{
 RowBox[{"WriteMatlab", "[", 
  RowBox[{"Js0", ",", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"folder", ",", "\"\<Foot_st_Jacobian.m\>\""}], "]"}], ",", 
   "js0"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"WriteMatlab", "[", 
  RowBox[{"Js1", ",", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"folder", ",", "\"\<Knee_st_Jacobian.m\>\""}], "]"}], ",", 
   "js1"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"WriteMatlab", "[", 
  RowBox[{"Js2", ",", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"folder", ",", "\"\<Hip_Jacobian.m\>\""}], "]"}], ",", "js2"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"WriteMatlab", "[", 
  RowBox[{"Js3", ",", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"folder", ",", "\"\<Knee_sw_Jacobian.m\>\""}], "]"}], ",", 
   "js3"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"WriteMatlab", "[", 
  RowBox[{"Js4", ",", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"folder", ",", "\"\<Foot_sw_Jacobian.m\>\""}], "]"}], ",", 
   "js4"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7668473967462254`*^9, 3.7668474024564037`*^9}, {
   3.7668474695593543`*^9, 3.7668474697558975`*^9}, {3.766847784087072*^9, 
   3.7668478419757366`*^9}, {3.7668480710616474`*^9, 3.766848091110597*^9}, {
   3.7668504617836914`*^9, 3.7668504802969027`*^9}, {3.7668506719744034`*^9, 
   3.766850685815195*^9}, {3.766853071465933*^9, 3.7668530716932955`*^9}, {
   3.7668531185865545`*^9, 3.7668531205381513`*^9}, {3.7668533695450726`*^9, 
   3.766853390729023*^9}, {3.7668540747274265`*^9, 3.7668540786947384`*^9}, {
   3.766854399462119*^9, 3.766854477603095*^9}, 3.7668545798447995`*^9, {
   3.766854952258715*^9, 3.766854973488822*^9}, {3.766855039073496*^9, 
   3.766855052017766*^9}, {3.7686547375662546`*^9, 3.7686547427169833`*^9}, {
   3.771605832033862*^9, 3.771605839537809*^9}, {3.772277780441394*^9, 
   3.772277856473636*^9}, {3.772279549692916*^9, 3.7722795606940947`*^9}, {
   3.7722796223555145`*^9, 3.772279622675598*^9}, 3.772279923053319*^9, {
   3.7725441926935205`*^9, 3.772544235537221*^9}, {3.777049991562661*^9, 
   3.777049992219898*^9}, 3.777118662325981*^9, 3.777818358659815*^9, {
   3.7846549611455154`*^9, 3.784655068760221*^9}, {3.784655101929146*^9, 
   3.7846551854639726`*^9}, 3.784655830985737*^9, {3.797342235190009*^9, 
   3.7973422561268*^9}, {3.8104675923652487`*^9, 3.810467599055205*^9}}],

Cell[BoxData[{
 RowBox[{"WriteMatlab", "[", 
  RowBox[{"Js0dot", ",", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"folder", ",", "\"\<Foot_st_Jacobian_Dot.m\>\""}], "]"}], ",", 
   "js0dot"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"WriteMatlab", "[", 
  RowBox[{"Js1dot", ",", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"folder", ",", "\"\<Knee_st_Jacobian_Dot.m\>\""}], "]"}], ",", 
   "js1dot"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"WriteMatlab", "[", 
  RowBox[{"Js2dot", ",", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"folder", ",", "\"\<Hip_Jacobian_Dot.m\>\""}], "]"}], ",", 
   "js2dot"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"WriteMatlab", "[", 
  RowBox[{"Js3dot", ",", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"folder", ",", "\"\<Knee_sw_Jacobian_Dot.m\>\""}], "]"}], ",", 
   "js3dot"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"WriteMatlab", "[", 
  RowBox[{"Js4dot", ",", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"folder", ",", "\"\<Foot_sw_Jacobian_Dot.m\>\""}], "]"}], ",", 
   "js4dot"}], "]"}]}], "Input",
 CellChangeTimes->{{3.810468073741516*^9, 3.810468092333429*^9}, {
  3.8104683673244953`*^9, 3.8104683751344414`*^9}}],

Cell[BoxData[{
 RowBox[{"WriteMatlab", "[", 
  RowBox[{"COM", ",", " ", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"folder", ",", "\"\<COM_pos.m\>\""}], "]"}], ",", "posCoM"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"WriteMatlab", "[", 
  RowBox[{"dCOM", ",", " ", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"folder", ",", "\"\<COM_vel.m\>\""}], "]"}], ",", "dCoM"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"WriteMatlab", "[", 
  RowBox[{"ddCOM", ",", " ", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"folder", ",", "\"\<COM_accel.m\>\""}], "]"}], ",", "ddCoM"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.7668473967462254`*^9, 3.7668474024564037`*^9}, {
   3.7668474695593543`*^9, 3.7668474697558975`*^9}, {3.766847784087072*^9, 
   3.7668478419757366`*^9}, {3.7668480710616474`*^9, 3.766848091110597*^9}, {
   3.7668504617836914`*^9, 3.7668504802969027`*^9}, {3.7668506719744034`*^9, 
   3.766850685815195*^9}, {3.766853071465933*^9, 3.7668530716932955`*^9}, {
   3.7668531185865545`*^9, 3.7668531205381513`*^9}, {3.7668533695450726`*^9, 
   3.766853390729023*^9}, {3.7668540747274265`*^9, 3.7668540786947384`*^9}, {
   3.766854399462119*^9, 3.766854477603095*^9}, 3.7668545798447995`*^9, {
   3.766854952258715*^9, 3.766854973488822*^9}, {3.766855039073496*^9, 
   3.766855052017766*^9}, {3.7686547375662546`*^9, 3.7686547427169833`*^9}, {
   3.771605832033862*^9, 3.771605839537809*^9}, {3.772277780441394*^9, 
   3.772277856473636*^9}, {3.772279549692916*^9, 3.7722795606940947`*^9}, {
   3.7722796223555145`*^9, 3.772279622675598*^9}, 3.772279923053319*^9, {
   3.7725441926935205`*^9, 3.772544235537221*^9}, {3.777049991562661*^9, 
   3.777049992219898*^9}, 3.777118662325981*^9, 3.777818358659815*^9, {
   3.7846549611455154`*^9, 3.784655068760221*^9}, {3.784655101929146*^9, 
   3.7846551854639726`*^9}, 3.784655830985737*^9, 3.810467605261201*^9, {
   3.8104676423160295`*^9, 3.810467671071989*^9}, 3.810468094811407*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"write", " ", "energy", " ", "functions"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"folder", " ", "=", " ", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
      "toplevelfolder", ",", "configfolder", ",", 
       "\"\<EnergyFunctions\\\\\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"dirname", "=", "folder"}], "}"}], ",", 
     RowBox[{"Switch", "[", 
      RowBox[{
       RowBox[{"FileType", "[", "dirname", "]"}], ",", "None", ",", 
       RowBox[{"CreateDirectory", "[", "dirname", "]"}], " ", 
       RowBox[{"(*", 
        RowBox[{"create", " ", "dir"}], "*)"}], ",", "Directory", ",", "Null",
        " ", 
       RowBox[{"(*", 
        RowBox[{"do", " ", "nothing"}], "*)"}], ",", "File", ",", 
       RowBox[{
       "Print", "[", "\"\<File with same name already exists!!\>\"", "]"}]}], 
      " ", 
      RowBox[{"(*", 
       RowBox[{"error", "!"}], "*)"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"WriteMatlab", "[", 
    RowBox[{"KE", ",", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"folder", ",", "\"\<Kinetic_energy.m\>\""}], "]"}], ",", "Ke"}],
     "]"}], "\[IndentingNewLine]", 
   RowBox[{"WriteMatlab", "[", 
    RowBox[{"PE", ",", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"folder", ",", "\"\<Potential_energy.m\>\""}], "]"}], ",", 
     "Pe"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7668475432072716`*^9, 3.7668475477684174`*^9}, 
   3.7668504338042464`*^9, {3.7668530695298395`*^9, 3.7668530798987293`*^9}, {
   3.7668533594830723`*^9, 3.766853367639927*^9}, {3.766854483188921*^9, 
   3.766854505253061*^9}, 3.7668545789148684`*^9, 3.766854995282686*^9, 
   3.7686547531060104`*^9, {3.769432665825548*^9, 3.7694326790870624`*^9}, 
   3.771605846371463*^9, {3.7722797472343807`*^9, 3.7722797477158823`*^9}, 
   3.772280059316539*^9, 3.7724712854977274`*^9, 3.7725443337349963`*^9, {
   3.777818087260631*^9, 3.7778180981406755`*^9}, {3.7778181871999645`*^9, 
   3.7778181943064384`*^9}, {3.777818558428881*^9, 3.777818559738714*^9}, {
   3.777902333908635*^9, 3.777902334120043*^9}, {3.777904101226956*^9, 
   3.777904103465877*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"write", " ", "dynamics", " ", "matrices"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"folder", " ", "=", " ", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
      "toplevelfolder", ",", "configfolder", ",", 
       "\"\<DynamicsFunctions\\\\\>\""}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"dirname", "=", "folder"}], "}"}], ",", 
     RowBox[{"Switch", "[", 
      RowBox[{
       RowBox[{"FileType", "[", "dirname", "]"}], ",", "None", ",", 
       RowBox[{"CreateDirectory", "[", "dirname", "]"}], " ", 
       RowBox[{"(*", 
        RowBox[{"create", " ", "dir"}], "*)"}], ",", "Directory", ",", "Null",
        " ", 
       RowBox[{"(*", 
        RowBox[{"do", " ", "nothing"}], "*)"}], ",", "File", ",", 
       RowBox[{
       "Print", "[", "\"\<File with same name already exists!!\>\"", "]"}]}], 
      " ", 
      RowBox[{"(*", 
       RowBox[{"error", "!"}], "*)"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"WriteMatlab", "[", 
    RowBox[{"Mmatrix", ",", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"folder", ",", "\"\<M_matrix.m\>\""}], "]"}], ",", "M"}], "]"}],
    "\[IndentingNewLine]", 
   RowBox[{"WriteMatlab", "[", 
    RowBox[{"Cmtx", ",", " ", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"folder", ",", "\"\<C_matrix.m\>\""}], "]"}], ",", "Cmat"}], 
    "]"}], "\[IndentingNewLine]", 
   RowBox[{"WriteMatlab", "[", 
    RowBox[{"Nvect", ",", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"folder", ",", "\"\<G_matrix.m\>\""}], "]"}], ",", "G"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.766847369204723*^9, 3.7668473878355303`*^9}, {
   3.766847585864328*^9, 3.7668476038959827`*^9}, {3.766850014475005*^9, 
   3.766850030554435*^9}, {3.7668513704203095`*^9, 3.7668514120052505`*^9}, {
   3.766852039183888*^9, 3.7668520503689537`*^9}, {3.7668522727052794`*^9, 
   3.766852275008807*^9}, {3.766853046421412*^9, 3.766853064043687*^9}, {
   3.7668533011781917`*^9, 3.766853344089145*^9}, {3.7668545084217052`*^9, 
   3.7668545783400555`*^9}, {3.7668549993942747`*^9, 3.766855030304912*^9}, {
   3.7669298825923967`*^9, 3.766929952780774*^9}, 3.768654755038561*^9, {
   3.7694326966967845`*^9, 3.769432710767831*^9}, {3.769432884128147*^9, 
   3.769432884270279*^9}, 3.7716058486581182`*^9, {3.772279044021554*^9, 
   3.772279091175994*^9}, 3.772280060947896*^9, 3.772471289153407*^9, 
   3.7725443358141966`*^9, {3.7778181024172745`*^9, 3.7778181249408045`*^9}, {
   3.777818172173375*^9, 3.777818173420313*^9}, {3.7778185620621676`*^9, 
   3.7778185637737646`*^9}, {3.7779023361173224`*^9, 3.7779023363458242`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Unset", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x1", "[", "t", "]"}], ",", " ", 
     RowBox[{"x2", "[", "t", "]"}], ",", " ", 
     RowBox[{"x3", "[", "t", "]"}], ",", " ", 
     RowBox[{"x4", "[", "t", "]"}], ",", 
     RowBox[{"x5", "[", "t", "]"}], ",", 
     RowBox[{"x6", "[", "t", "]"}], ",", 
     RowBox[{
      RowBox[{"x1", "'"}], "[", "t", "]"}], ",", " ", 
     RowBox[{
      RowBox[{"x2", "'"}], "[", "t", "]"}], ",", " ", 
     RowBox[{
      RowBox[{"x3", "'"}], "[", "t", "]"}], ",", " ", 
     RowBox[{
      RowBox[{"x4", "'"}], "[", "t", "]"}], ",", " ", 
     RowBox[{
      RowBox[{"x5", "'"}], "[", "t", "]"}], ",", 
     RowBox[{
      RowBox[{"x6", "'"}], "[", "t", "]"}], ",", " ", 
     RowBox[{
      RowBox[{"x1", "''"}], "[", "t", "]"}], ",", " ", 
     RowBox[{
      RowBox[{"x2", "''"}], "[", "t", "]"}], ",", " ", 
     RowBox[{
      RowBox[{"x3", "''"}], "[", "t", "]"}], ",", 
     RowBox[{
      RowBox[{"x4", "''"}], "[", "t", "]"}], ",", 
     RowBox[{
      RowBox[{"x5", "''"}], "[", "t", "]"}], ",", 
     RowBox[{
      RowBox[{"x6", "''"}], "[", "t", "]"}]}], "}"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.766934307338765*^9, 3.7669344074321623`*^9}}]
}, Open  ]]
},
WindowSize->{1920, 997},
WindowMargins->{{1912, Automatic}, {Automatic, -6}},
PrintingCopies->1,
PrintingPageRange->{Automatic, Automatic},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
ShowSelection->True,
Magnification:>0.9 Inherited,
FrontEndVersion->"10.4 for Microsoft Windows (64-bit) (February 25, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 279, 4, 61, "Section"],
Cell[CellGroupData[{
Cell[871, 30, 1040, 26, 170, "Input"],
Cell[1914, 58, 471, 10, 19, "Message"],
Cell[2388, 70, 465, 7, 28, "Output"],
Cell[2856, 79, 467, 7, 28, "Output"],
Cell[3326, 88, 467, 7, 28, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[3842, 101, 245, 3, 61, "Section"],
Cell[4090, 106, 3237, 60, 50, "Input"],
Cell[7330, 168, 5415, 124, 290, "Input"],
Cell[12748, 294, 6271, 139, 370, "Input"],
Cell[19022, 435, 1707, 44, 150, "Input"],
Cell[20732, 481, 6898, 171, 130, "Input"],
Cell[CellGroupData[{
Cell[27655, 656, 2959, 63, 130, "Input"],
Cell[30617, 721, 4350, 123, 86, "Output"]
}, Open  ]],
Cell[34982, 847, 4200, 102, 130, "Input"],
Cell[39185, 951, 1097, 35, 130, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40319, 991, 213, 3, 61, "Section"],
Cell[CellGroupData[{
Cell[40557, 998, 221, 3, 35, "Subsubsection"],
Cell[40781, 1003, 4154, 112, 110, "Input"],
Cell[CellGroupData[{
Cell[44960, 1119, 1131, 26, 50, "Input"],
Cell[46094, 1147, 16970, 465, 148, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[63113, 1618, 216, 3, 35, "Subsubsection"],
Cell[63332, 1623, 3042, 78, 110, "Input"],
Cell[CellGroupData[{
Cell[66399, 1705, 348, 5, 29, "Input"],
Cell[66750, 1712, 29574, 776, 204, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[96373, 2494, 175, 2, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[96573, 2500, 1801, 43, 70, "Input"],
Cell[98377, 2545, 12615, 329, 137, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[111053, 2881, 385, 6, 68, "Section"],
Cell[CellGroupData[{
Cell[111463, 2891, 326, 4, 35, "Subsubsection"],
Cell[111792, 2897, 2329, 65, 90, "Input"]
}, Open  ]],
Cell[114136, 2965, 417, 6, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[114578, 2975, 484, 6, 30, "Subsubsection"],
Cell[115065, 2983, 1573, 38, 110, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[116687, 3027, 91, 1, 61, "Section"],
Cell[116781, 3030, 4198, 109, 90, "Input"],
Cell[120982, 3141, 1993, 31, 50, "Input"],
Cell[122978, 3174, 3771, 80, 190, "Input"],
Cell[126752, 3256, 2207, 42, 110, "Input"],
Cell[128962, 3300, 2339, 43, 110, "Input"],
Cell[131304, 3345, 1161, 27, 110, "Input"],
Cell[132468, 3374, 1942, 33, 70, "Input"],
Cell[134413, 3409, 2249, 50, 110, "Input"],
Cell[136665, 3461, 2724, 59, 130, "Input"],
Cell[139392, 3522, 1249, 35, 29, "Input"]
}, Open  ]]
}
]
*)

